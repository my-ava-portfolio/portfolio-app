"use strict";(self.webpackChunkportfolio=self.webpackChunkportfolio||[]).push([[840],{8840:(gr,We,m)=>{m.r(We),m.d(We,{MapSandboxModule:()=>ur});var w=m(6895),A=m(2216),Ie=m(646),_=m(2687),n=m(4650),Se=m(9947),It=m(3686),Y=m(7579);let ne=(()=>{class o{constructor(){this.layerIdSelected=new Y.x,this.allLayers=new Y.x,this.removeLayers=new Y.x}sendAllLayers(e){this.allLayers.next(e)}removeAllLayers(){this.removeLayers.next(!0)}sendSelectedLayerId(e){this.layerIdSelected.next(e)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=n.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),St=(()=>{class o{constructor(e){this._elemRef=e,this.setHeight()}ngAfterViewChecked(){this.setHeight()}onResize(e){this.setHeight()}setHeight(){this._elemRef.nativeElement.style.height=window.innerHeight-this._elemRef.nativeElement.offsetTop+"px"}}return o.\u0275fac=function(e){return new(e||o)(n.Y36(n.SBq))},o.\u0275dir=n.lG2({type:o,selectors:[["","fluidHeight",""]],hostBindings:function(e,i){1&e&&n.NdJ("resize",function(s){return i.onResize(s)},!1,n.Jf7)}}),o})(),Me=(()=>{class o{constructor(e,i){this._elemRef=e,this.renderer=i,this.isRemoved=!1,this.renderer.appendChild(document.body,this._elemRef.nativeElement)}ngOnChanges(e){e.isRemoved.currentValue&&this.ngOnDestroy()}ngOnDestroy(){this.renderer.removeChild(document.body,this._elemRef.nativeElement)}}return o.\u0275fac=function(e){return new(e||o)(n.Y36(n.SBq),n.Y36(n.Qsj))},o.\u0275dir=n.lG2({type:o,selectors:[["","moveDivToBody",""]],inputs:{isRemoved:"isRemoved"},features:[n.TTD]}),o})();var S=m(3171),K=m(9972),Mt=m(7660),x=m(760),M=m(1729);class ie extends Mt.Z{constructor(t){super(),this.geometries_=t||null,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(M.bN),this.changeEventsKeys_.length=0}listenGeometriesChange_(){if(this.geometries_)for(let t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push((0,M.oL)(this.geometries_[t],K.Z.CHANGE,this.changed,this))}clone(){const t=new ie(null);return t.setGeometries(this.geometries_),t.applyProperties(this),t}closestPointXY(t,e,i,r){if(r<(0,x.qf)(this.getExtent(),t,e))return r;const s=this.geometries_;for(let a=0,l=s.length;a<l;++a)r=s[a].closestPointXY(t,e,i,r);return r}containsXY(t,e){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)if(i[r].containsXY(t,e))return!0;return!1}computeExtent(t){(0,x.YN)(t);const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)(0,x.l7)(t,e[i].getExtent());return t}getGeometries(){return Xe(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let r=!1;for(let s=0,a=i.length;s<a;++s){const l=i[s],c=l.getSimplifiedGeometry(t);e.push(c),c!==l&&(r=!0)}if(r){const s=new ie(null);return s.setGeometriesArray(e),s}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return 0===this.geometries_.length}rotate(t,e){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].rotate(t,e);this.changed()}scale(t,e,i){i||(i=(0,x.qg)(this.getExtent()));const r=this.geometries_;for(let s=0,a=r.length;s<a;++s)r[s].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(Xe(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Xe(o){const t=[];for(let e=0,i=o.length;e<i;++e)t.push(o[e].clone());return t}const W=ie;var T=m(119),y=m(6003);const ze=class kt{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?(0,y.U2)(e.dataProjection):this.readProjection(t);e.extent&&i&&"tile-pixels"===i.getUnits()&&(i=(0,y.U2)(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)}getType(){return(0,T.O3)()}readFeature(t,e){return(0,T.O3)()}readFeatures(t,e){return(0,T.O3)()}readGeometry(t,e){return(0,T.O3)()}readProjection(t){return(0,T.O3)()}writeFeature(t,e){return(0,T.O3)()}writeFeatures(t,e){return(0,T.O3)()}writeGeometry(t,e){return(0,T.O3)()}};function re(o,t,e){const i=e?(0,y.U2)(e.featureProjection):null,r=e?(0,y.U2)(e.dataProjection):null;let s;if(s=i&&r&&!(0,y.OP)(i,r)?(t?o.clone():o).transform(t?i:r,t?r:i):o,t&&e&&void 0!==e.decimals){const a=Math.pow(10,e.decimals),l=function(c){for(let d=0,u=c.length;d<u;++d)c[d]=Math.round(c[d]*a)/a;return c};s===o&&(s=o.clone()),s.applyTransform(l)}return s}function se(o){return"string"==typeof o?JSON.parse(o)||null:null!==o?o:null}const Gt=class Zt extends ze{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(se(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(se(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return(0,T.O3)()}readFeaturesFromObject(t,e){return(0,T.O3)()}readGeometry(t,e){return this.readGeometryFromObject(se(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return(0,T.O3)()}readProjection(t){return this.readProjectionFromObject(se(t))}readProjectionFromObject(t){return(0,T.O3)()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return(0,T.O3)()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return(0,T.O3)()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return(0,T.O3)()}};var O=m(6527),B=m(2774),oe=m(5066),ae=m(8999),$e=m(9182),D=m(2456),ke=m(392),et=m(410),tt=m(9644);class le extends B.ZP{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(void 0!==e&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{let r=this.getLayout();const s=t,a=[],l=[];for(let c=0,d=s.length;c<d;++c){const u=s[c];0===c&&(r=u.getLayout()),(0,D.l7)(a,u.getFlatCoordinates()),l.push(a.length)}this.setFlatCoordinates(r,a),this.ends_=l}}appendLineString(t){this.flatCoordinates?(0,D.l7)(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new le(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<(0,x.qf)(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,oe.Af)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,oe.Xl)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,r))}getCoordinateAtM(t,e,i){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(0,et.dG)(this.flatCoordinates,0,this.ends_,this.stride,t,e=void 0!==e&&e,i=void 0!==i&&i)}getCoordinates(){return(0,ke.o1)(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new O.Z(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,r=[];let s=0;for(let a=0,l=e.length;a<l;++a){const c=e[a],d=new O.Z(t.slice(s,c),i);r.push(d),s=c}return r}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const r=this.ends_,s=this.stride;for(let a=0,l=r.length;a<l;++a){const c=r[a],d=(0,et.WW)(e,i,c,s,.5);(0,D.l7)(t,d),i=c}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=(0,$e.UJ)(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new le(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return(0,tt.AW)(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=(0,ae._5)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}const ce=le;var N=m(187),X=m(2156);class Ze extends B.ZP{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){this.flatCoordinates?(0,D.l7)(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()}clone(){const t=new Ze(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){if(r<(0,x.qf)(this.getExtent(),t,e))return r;const s=this.flatCoordinates,a=this.stride;for(let l=0,c=s.length;l<c;l+=a){const d=(0,X.bI)(t,e,s[l],s[l+1]);if(d<r){r=d;for(let u=0;u<a;++u)i[u]=s[l+u];i.length=a}}return r}getCoordinates(){return(0,ke.Ml)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){return t<0||(this.flatCoordinates?this.flatCoordinates.length/this.stride:0)<=t?null:new N.Z(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,r=[];for(let s=0,a=t.length;s<a;s+=i){const l=new N.Z(t.slice(s,s+i),e);r.push(l)}return r}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let r=0,s=e.length;r<s;r+=i)if((0,x.jE)(t,e[r],e[r+1]))return!0;return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,ae.Sg)(this.flatCoordinates,0,t,this.stride),this.changed()}}const de=Ze;var G=m(2275),At=m(2474),Ge=m(1265),Ot=m(8818),Dt=m(4325);class ue extends B.ZP{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){let r=this.getLayout();const s=t,a=[],l=[];for(let c=0,d=s.length;c<d;++c){const u=s[c];0===c&&(r=u.getLayout());const p=a.length,h=u.getEnds();for(let g=0,f=h.length;g<f;++g)h[g]+=p;(0,D.l7)(a,u.getFlatCoordinates()),l.push(h)}e=r,t=a,i=l}void 0!==e&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(this.flatCoordinates){const i=this.flatCoordinates.length;(0,D.l7)(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let r=0,s=e.length;r<s;++r)e[r]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let r=0;r<t;++r)e[r]=this.endss_[r].slice();const i=new ue(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,r){return r<(0,x.qf)(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,oe.sD)(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,oe.gI)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,r))}containsXY(t,e){return(0,Dt.Zl)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return(0,Ot.Eu)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),(0,Ge.dL)(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,(0,ke.ug)(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=function Nt(o,t,e,i){const r=[];let s=(0,x.lJ)();for(let a=0,l=e.length;a<l;++a){const c=e[a];s=(0,x.GN)(o,t,c[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),t=c[c.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=(0,At.U)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new de(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;(0,Ge.Oj)(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=(0,Ge.dL)(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=(0,$e.Pp)(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new ue(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(0===t)e=0;else{const s=this.endss_[t-1];e=s[s.length-1]}const i=this.endss_[t].slice(),r=i[i.length-1];if(0!==e)for(let s=0,a=i.length;s<a;++s)i[s]-=e;return new G.ZP(this.flatCoordinates.slice(e,r),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,r=[];let s=0;for(let a=0,l=i.length;a<l;++a){const c=i[a].slice(),d=c[c.length-1];if(0!==s)for(let p=0,h=c.length;p<h;++p)c[p]-=s;const u=new G.ZP(e.slice(s,d),t,c);r.push(u),s=d}return r}getType(){return"MultiPolygon"}intersectsExtent(t){return(0,tt.oW)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=(0,ae.QT)(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{const r=i[i.length-1];this.flatCoordinates.length=0===r.length?0:r[r.length-1]}this.changed()}}const he=ue;var Jt=m(1911),Rt=m(9466);function Ae(o,t){if(!o)return null;let e;switch(o.type){case"Point":e=function Bt(o){return new N.Z(o.coordinates)}(o);break;case"LineString":e=function Qt(o){return new O.Z(o.coordinates)}(o);break;case"Polygon":e=function Yt(o){return new G.ZP(o.coordinates)}(o);break;case"MultiPoint":e=function Ht(o){return new de(o.coordinates)}(o);break;case"MultiLineString":e=function qt(o){return new ce(o.coordinates)}(o);break;case"MultiPolygon":e=function Vt(o){return new he(o.coordinates)}(o);break;case"GeometryCollection":e=function Ut(o,t){const e=o.geometries.map(function(i){return Ae(i,t)});return new W(e)}(o);break;default:throw new Error("Unsupported GeoJSON type: "+o.type)}return re(e,!1,t)}function Oe(o,t){const e=(o=re(o,!0,t)).getType();let i;switch(e){case"Point":i=function en(o,t){return{type:"Point",coordinates:o.getCoordinates()}}(o);break;case"LineString":i=function Wt(o,t){return{type:"LineString",coordinates:o.getCoordinates()}}(o);break;case"Polygon":i=function tn(o,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:o.getCoordinates(e)}}(o,t);break;case"MultiPoint":i=function zt(o,t){return{type:"MultiPoint",coordinates:o.getCoordinates()}}(o);break;case"MultiLineString":i=function Xt(o,t){return{type:"MultiLineString",coordinates:o.getCoordinates()}}(o);break;case"MultiPolygon":i=function $t(o,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:o.getCoordinates(e)}}(o,t);break;case"GeometryCollection":i=function Kt(o,t){return delete(t=Object.assign({},t)).featureProjection,{type:"GeometryCollection",geometries:o.getGeometriesArray().map(function(i){return Oe(i,t)})}}(o,t);break;case"Circle":i={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+e)}return i}const nt=class jt extends Gt{constructor(t){t=t||{},super(),this.dataProjection=(0,y.U2)(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=(0,y.U2)(t.featureProjection)),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;i="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null};const r=Ae(i.geometry,e),s=new S.Z;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in i!==void 0&&s.setGeometryName(i.geometry_name),s.setGeometry(r),"id"in i&&s.setId(i.id),i.properties&&s.setProperties(i.properties,!0),s}readFeaturesFromObject(t,e){let r=null;if("FeatureCollection"===t.type){r=[];const a=t.features;for(let l=0,c=a.length;l<c;++l)r.push(this.readFeatureFromObject(a[l],e))}else r=[this.readFeatureFromObject(t,e)];return r}readGeometryFromObject(t,e){return Ae(t,e)}readProjectionFromObject(t){const e=t.crs;let i;return e?"name"==e.type?i=(0,y.U2)(e.properties.name):"EPSG"===e.type?i=(0,y.U2)("EPSG:"+e.properties.code):(0,Jt.h)(!1,36):i=this.dataProjection,i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},r=t.getId();if(void 0!==r&&(i.id=r),!t.hasProperties())return i;const s=t.getProperties(),a=t.getGeometry();return a&&(i.geometry=Oe(a,e),delete s[t.getGeometryName()]),(0,Rt.x)(s)||(i.properties=s),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let r=0,s=t.length;r<s;++r)i.push(this.writeFeatureObject(t[r],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return Oe(t,this.adaptOptions(e))}};var Ne=m(7053),z=m(5947);const it={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let ge;const nn=new Uint8Array(16);function rn(){if(!ge&&(ge=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ge))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ge(nn)}const L=[];for(let o=0;o<256;++o)L.push((o+256).toString(16).slice(1));const st=function sn(o,t,e){if(it.randomUUID&&!t&&!o)return it.randomUUID();const i=(o=o||{}).random||(o.rng||rn)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){e=e||0;for(let r=0;r<16;++r)t[e+r]=i[r];return t}return function rt(o,t=0){return(L[o[t+0]]+L[o[t+1]]+L[o[t+2]]+L[o[t+3]]+"-"+L[o[t+4]]+L[o[t+5]]+"-"+L[o[t+6]]+L[o[t+7]]+"-"+L[o[t+8]]+L[o[t+9]]+"-"+L[o[t+10]]+L[o[t+11]]+L[o[t+12]]+L[o[t+13]]+L[o[t+14]]+L[o[t+15]]).toLowerCase()}(i)},ot=/^#([0-9a-f]{3}){1,2}$/i,ln=["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928","#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999","#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],dn=_.diR,un=_.fQK,hn=_.ubJ;var k=m(6597),gn=m(154),pn=m(3324),pe=m(9889),fe=m(5002),at=m(2909),me=m(4412),Q=m(1345),P=m(3481);function lt(o){return o.feature?o.feature:o.element?o.element:void 0}const De=[],mn=class fn extends fe.Z{constructor(t){const e=t=t||{};e.handleDownEvent||(e.handleDownEvent=Q.uX),e.stopDown||(e.stopDown=Q.Dv),super(e),this.source_=t.source?t.source:null,this.vertex_=void 0===t.vertex||t.vertex,this.edge_=void 0===t.edge||t.edge,this.features_=t.features?t.features:null,this.featuresListenerKeys_=[],this.featureChangeListenerKeys_={},this.indexedFeaturesExtents_={},this.pendingFeatures_={},this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.rBush_=new at.Z,this.GEOMETRY_SEGMENTERS_={Point:this.segmentPointGeometry_.bind(this),LineString:this.segmentLineStringGeometry_.bind(this),LinearRing:this.segmentLineStringGeometry_.bind(this),Polygon:this.segmentPolygonGeometry_.bind(this),MultiPoint:this.segmentMultiPointGeometry_.bind(this),MultiLineString:this.segmentMultiLineStringGeometry_.bind(this),MultiPolygon:this.segmentMultiPolygonGeometry_.bind(this),GeometryCollection:this.segmentGeometryCollectionGeometry_.bind(this),Circle:this.segmentCircleGeometry_.bind(this)}}addFeature(t,e){e=void 0===e||e;const i=(0,T.sq)(t),r=t.getGeometry();if(r){const s=this.GEOMETRY_SEGMENTERS_[r.getType()];if(s){this.indexedFeaturesExtents_[i]=r.getExtent((0,x.lJ)());const a=[];if(s(a,r),1===a.length)this.rBush_.insert((0,x.hI)(a[0]),{feature:t,segment:a[0]});else if(a.length>1){const l=a.map(d=>(0,x.hI)(d)),c=a.map(d=>({feature:t,segment:d}));this.rBush_.load(l,c)}}}e&&(this.featureChangeListenerKeys_[i]=(0,M.oL)(t,K.Z.CHANGE,this.handleFeatureChange_,this))}getFeatures_(){let t;return this.features_?t=this.features_:this.source_&&(t=this.source_.getFeatures()),t}handleEvent(t){const e=this.snapTo(t.pixel,t.coordinate,t.map);return e&&(t.coordinate=e.vertex.slice(0,2),t.pixel=e.vertexPixel),super.handleEvent(t)}handleFeatureAdd_(t){const e=lt(t);this.addFeature(e)}handleFeatureRemove_(t){const e=lt(t);this.removeFeature(e)}handleFeatureChange_(t){const e=t.target;if(this.handlingDownUpSequence){const i=(0,T.sq)(e);i in this.pendingFeatures_||(this.pendingFeatures_[i]=e)}else this.updateFeature_(e)}handleUpEvent(t){const e=Object.values(this.pendingFeatures_);return e.length&&(e.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1}removeFeature(t,e){const i=void 0===e||e,r=(0,T.sq)(t),s=this.indexedFeaturesExtents_[r];if(s){const a=this.rBush_,l=[];a.forEachInExtent(s,function(c){t===c.feature&&l.push(c)});for(let c=l.length-1;c>=0;--c)a.remove(l[c])}i&&((0,M.bN)(this.featureChangeListenerKeys_[r]),delete this.featureChangeListenerKeys_[r])}setMap(t){const e=this.getMap(),i=this.featuresListenerKeys_,r=this.getFeatures_();e&&(i.forEach(M.bN),i.length=0,this.rBush_.clear(),Object.values(this.featureChangeListenerKeys_).forEach(M.bN),this.featureChangeListenerKeys_={}),super.setMap(t),t&&(this.features_?i.push((0,M.oL)(this.features_,pe.Z.ADD,this.handleFeatureAdd_,this),(0,M.oL)(this.features_,pe.Z.REMOVE,this.handleFeatureRemove_,this)):this.source_&&i.push((0,M.oL)(this.source_,me.Z.ADDFEATURE,this.handleFeatureAdd_,this),(0,M.oL)(this.source_,me.Z.REMOVEFEATURE,this.handleFeatureRemove_,this)),r.forEach(s=>this.addFeature(s)))}snapTo(t,e,i){const r=i.getView().getProjection(),s=(0,y.Vs)(e,r),a=(0,y.Fj)((0,x.f3)((0,x.hI)([s]),i.getView().getResolution()*this.pixelTolerance_),r),l=this.rBush_.getInExtent(a),c=l.length;if(0===c)return null;let d,u=1/0;const p=this.pixelTolerance_*this.pixelTolerance_,h=()=>{if(d){const g=i.getPixelFromCoordinate(d);if((0,P.bI)(t,g)<=p)return{vertex:d,vertexPixel:[Math.round(g[0]),Math.round(g[1])]}}return null};if(this.vertex_){for(let f=0;f<c;++f){const C=l[f];"Circle"!==C.feature.getGeometry().getType()&&C.segment.forEach(b=>{const F=(0,y.Vs)(b,r),E=(0,P.bI)(s,F);E<u&&(d=b,u=E)})}const g=h();if(g)return g}if(this.edge_){for(let f=0;f<c;++f){let C=null;const b=l[f];if("Circle"===b.feature.getGeometry().getType()){let F=b.feature.getGeometry();const E=(0,y.Cs)();E&&(F=F.clone().transform(E,r)),C=(0,P.Ed)(s,F)}else{const[F,E]=b.segment;E&&(De[0]=(0,y.Vs)(F,r),De[1]=(0,y.Vs)(E,r),C=(0,P.oL)(s,De))}if(C){const F=(0,P.bI)(s,C);F<u&&(d=(0,y.lO)(C,r),u=F)}}const g=h();if(g)return g}return null}updateFeature_(t){this.removeFeature(t,!1),this.addFeature(t,!1)}segmentCircleGeometry_(t,e){const i=this.getMap().getView().getProjection();let r=e;const s=(0,y.Cs)();s&&(r=r.clone().transform(s,i));const a=(0,G.Bb)(r);s&&a.transform(i,s);const l=a.getCoordinates()[0];for(let c=0,d=l.length-1;c<d;++c)t.push(l.slice(c,c+2))}segmentGeometryCollectionGeometry_(t,e){const i=e.getGeometriesArray();for(let r=0;r<i.length;++r){const s=this.GEOMETRY_SEGMENTERS_[i[r].getType()];s&&s(t,i[r])}}segmentLineStringGeometry_(t,e){const i=e.getCoordinates();for(let r=0,s=i.length-1;r<s;++r)t.push(i.slice(r,r+2))}segmentMultiLineStringGeometry_(t,e){const i=e.getCoordinates();for(let r=0,s=i.length;r<s;++r){const a=i[r];for(let l=0,c=a.length-1;l<c;++l)t.push(a.slice(l,l+2))}}segmentMultiPointGeometry_(t,e){e.getCoordinates().forEach(i=>{t.push([i])})}segmentMultiPolygonGeometry_(t,e){const i=e.getCoordinates();for(let r=0,s=i.length;r<s;++r){const a=i[r];for(let l=0,c=a.length;l<c;++l){const d=a[l];for(let u=0,p=d.length-1;u<p;++u)t.push(d.slice(u,u+2))}}}segmentPointGeometry_(t,e){t.push([e.getCoordinates()])}segmentPolygonGeometry_(t,e){const i=e.getCoordinates();for(let r=0,s=i.length;r<s;++r){const a=i[r];for(let l=0,c=a.length-1;l<c;++l)t.push(a.slice(l,l+2))}}};var $=m(2815),Je=m(8214),ct=m(7366);class je extends Je.ZP{constructor(t,e,i,r,s){super(t),this.features=e,this.coordinate=i,this.startCoordinate=r,this.mapBrowserEvent=s}}const yn=class _n extends fe.Z{constructor(t){let e;if(super(t=t||{}),this.lastCoordinate_=null,this.startCoordinate_=null,this.features_=void 0!==t.features?t.features:null,t.layers&&!this.features_)if("function"==typeof t.layers)e=t.layers;else{const i=t.layers;e=function(r){return i.includes(r)}}else e=Q.uX;this.layerFilter_=e,this.filter_=t.filter&&!this.features_?t.filter:Q.uX,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0,this.condition_=t.condition?t.condition:k.Bx,this.lastFeature_=null,this.addChangeListener(ct.Z.ACTIVE,this.handleActiveChanged_)}handleDownEvent(t){if(!t.originalEvent||!this.condition_(t))return!1;if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=t.coordinate,this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);const e=this.features_||new $.Z([this.lastFeature_]);return this.dispatchEvent(new je("translatestart",e,t.coordinate,this.startCoordinate_,t)),!0}return!1}handleUpEvent(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);const e=this.features_||new $.Z([this.lastFeature_]);return this.dispatchEvent(new je("translateend",e,t.coordinate,this.startCoordinate_,t)),this.startCoordinate_=null,!0}return!1}handleDragEvent(t){if(this.lastCoordinate_){const e=t.coordinate,i=e[0]-this.lastCoordinate_[0],r=e[1]-this.lastCoordinate_[1],s=this.features_||new $.Z([this.lastFeature_]);s.forEach(function(a){const l=a.getGeometry();l.translate(i,r),a.setGeometry(l)}),this.lastCoordinate_=e,this.dispatchEvent(new je("translating",s,e,this.startCoordinate_,t))}}handleMoveEvent(t){const e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")}featuresAtPixel_(t,e){return e.forEachFeatureAtPixel(t,(i,r)=>{if(i instanceof S.Z&&this.filter_(i,r)&&(!this.features_||this.features_.getArray().includes(i)))return i},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}getHitTolerance(){return this.hitTolerance_}setHitTolerance(t){this.hitTolerance_=t}setMap(t){const e=this.getMap();super.setMap(t),this.updateState_(e)}handleActiveChanged_(){this.updateState_(null)}updateState_(t){let e=this.getMap();const i=this.getActive();(!e||!i)&&(e=e||t,e&&e.getViewport().classList.remove("ol-grab","ol-grabbing"))}};var Z=m(4624),J=m(109);const ee=1,ut=[0,0,0,0],q=[];class Be extends Je.ZP{constructor(t,e,i){super(t),this.features=e,this.mapBrowserEvent=i}}function xn(o,t){return o.index-t.index}function ht(o,t,e){const i=t.geometry;if("Circle"===i.getType()){let s=i;if(t.index===ee){const a=(0,y.Cs)();a&&(s=s.clone().transform(a,e));const l=(0,P.bI)(s.getCenter(),(0,y.Vs)(o,e)),c=Math.sqrt(l)-s.getRadius();return c*c}}const r=(0,y.Vs)(o,e);return q[0]=(0,y.Vs)(t.segment[0],e),q[1]=(0,y.Vs)(t.segment[1],e),(0,P.Bs)(r,q)}function gt(o,t,e){const i=t.geometry;if("Circle"===i.getType()&&t.index===ee){let s=i;const a=(0,y.Cs)();return a&&(s=s.clone().transform(a,e)),(0,y.lO)(s.getClosestPoint((0,y.Vs)(o,e)),e)}const r=(0,y.Vs)(o,e);return q[0]=(0,y.Vs)(t.segment[0],e),q[1]=(0,y.Vs)(t.segment[1],e),(0,y.lO)((0,P.oL)(r,q),e)}function Tn(){const o=(0,J.Ly)();return function(t,e){return o.Point}}const vn=class Cn extends fe.Z{constructor(t){let e;if(super(t),this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=t.condition?t.condition:k.Xp,this.defaultDeleteCondition_=function(i){return(0,k.Ko)(i)&&(0,k.Kf)(i)},this.deleteCondition_=t.deleteCondition?t.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:k.Bx,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new at.Z,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new Ne.Z({source:new z.Z({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:Tn(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null,t.features?e=t.features:t.source&&(this.source_=t.source,e=new $.Z(this.source_.getFeatures()),this.source_.addEventListener(me.Z.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(me.Z.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!e)throw new Error("The modify interaction requires features, a source or a layer");t.hitDetection&&(this.hitDetection_=t.hitDetection),this.features_=e,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(pe.Z.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(pe.Z.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=void 0===t.snapToPointer?!this.hitDetection_:t.snapToPointer}addFeature_(t){const e=t.getGeometry();if(e){const r=this.SEGMENT_WRITERS_[e.getType()];r&&r(t,e)}const i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),t.addEventListener(K.Z.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(t,e){if(!this.featuresBeingModified_){this.featuresBeingModified_=new $.Z;const i=this.featuresBeingModified_.getArray();for(let r=0,s=e.length;r<s;++r){const a=e[r];for(let l=0,c=a.length;l<c;++l){const d=a[l].feature;d&&!i.includes(d)&&this.featuresBeingModified_.push(d)}}0===this.featuresBeingModified_.getLength()?this.featuresBeingModified_=null:this.dispatchEvent(new Be("modifystart",this.featuresBeingModified_,t))}}removeFeature_(t){this.removeFeatureSegmentData_(t),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.removeEventListener(K.Z.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(t){const e=this.rBush_,i=[];e.forEach(function(r){t===r.feature&&i.push(r)});for(let r=i.length-1;r>=0;--r){const s=i[r];for(let a=this.dragSegments_.length-1;a>=0;--a)this.dragSegments_[a][0]===s&&this.dragSegments_.splice(a,1);e.remove(s)}}setActive(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(t)}setMap(t){this.overlay_.setMap(t),super.setMap(t)}getOverlay(){return this.overlay_}handleSourceAdd_(t){t.feature&&this.features_.push(t.feature)}handleSourceRemove_(t){t.feature&&this.features_.remove(t.feature)}handleFeatureAdd_(t){this.addFeature_(t.element)}handleFeatureChange_(t){if(!this.changingFeature_){const e=t.target;this.removeFeature_(e),this.addFeature_(e)}}handleFeatureRemove_(t){this.removeFeature_(t.element)}writePointGeometry_(t,e){const i=e.getCoordinates(),r={feature:t,geometry:e,segment:[i,i]};this.rBush_.insert(e.getExtent(),r)}writeMultiPointGeometry_(t,e){const i=e.getCoordinates();for(let r=0,s=i.length;r<s;++r){const a=i[r],l={feature:t,geometry:e,depth:[r],index:r,segment:[a,a]};this.rBush_.insert(e.getExtent(),l)}}writeLineStringGeometry_(t,e){const i=e.getCoordinates();for(let r=0,s=i.length-1;r<s;++r){const a=i.slice(r,r+2),l={feature:t,geometry:e,index:r,segment:a};this.rBush_.insert((0,x.hI)(a),l)}}writeMultiLineStringGeometry_(t,e){const i=e.getCoordinates();for(let r=0,s=i.length;r<s;++r){const a=i[r];for(let l=0,c=a.length-1;l<c;++l){const d=a.slice(l,l+2),u={feature:t,geometry:e,depth:[r],index:l,segment:d};this.rBush_.insert((0,x.hI)(d),u)}}}writePolygonGeometry_(t,e){const i=e.getCoordinates();for(let r=0,s=i.length;r<s;++r){const a=i[r];for(let l=0,c=a.length-1;l<c;++l){const d=a.slice(l,l+2),u={feature:t,geometry:e,depth:[r],index:l,segment:d};this.rBush_.insert((0,x.hI)(d),u)}}}writeMultiPolygonGeometry_(t,e){const i=e.getCoordinates();for(let r=0,s=i.length;r<s;++r){const a=i[r];for(let l=0,c=a.length;l<c;++l){const d=a[l];for(let u=0,p=d.length-1;u<p;++u){const h=d.slice(u,u+2),g={feature:t,geometry:e,depth:[l,r],index:u,segment:h};this.rBush_.insert((0,x.hI)(h),g)}}}}writeCircleGeometry_(t,e){const i=e.getCenter(),r={feature:t,geometry:e,index:0,segment:[i,i]},s={feature:t,geometry:e,index:ee,segment:[i,i]},a=[r,s];r.featureSegments=a,s.featureSegments=a,this.rBush_.insert((0,x.HK)(i),r);let l=e;const c=(0,y.Cs)();if(c&&this.getMap()){const d=this.getMap().getView().getProjection();l=l.clone().transform(c,d),l=(0,G.Bb)(l).transform(d,c)}this.rBush_.insert(l.getExtent(),s)}writeGeometryCollectionGeometry_(t,e){const i=e.getGeometriesArray();for(let r=0;r<i.length;++r){const s=i[r];(0,this.SEGMENT_WRITERS_[s.getType()])(t,s)}}createOrUpdateVertexFeature_(t,e,i){let r=this.vertexFeature_;return r?r.getGeometry().setCoordinates(t):(r=new S.Z(new N.Z(t)),this.vertexFeature_=r,this.overlay_.getSource().addFeature(r)),r.set("features",e),r.set("geometries",i),r}handleEvent(t){if(!t.originalEvent)return!0;let e;return this.lastPointerEvent_=t,!t.map.getView().getInteracting()&&t.type==Z.Z.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(e=!(t.type!=Z.Z.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),t.type==Z.Z.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(t)&&!e}handleDragEvent(t){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(t,this.dragSegments_);const e=[t.coordinate[0]+this.delta_[0],t.coordinate[1]+this.delta_[1]],i=[],r=[];for(let s=0,a=this.dragSegments_.length;s<a;++s){const l=this.dragSegments_[s],c=l[0],d=c.feature;i.includes(d)||i.push(d);const u=c.geometry;r.includes(u)||r.push(u);const p=c.depth;let h;const g=c.segment,f=l[1];for(;e.length<u.getStride();)e.push(g[f][e.length]);switch(u.getType()){case"Point":h=e,g[0]=e,g[1]=e;break;case"MultiPoint":h=u.getCoordinates(),h[c.index]=e,g[0]=e,g[1]=e;break;case"LineString":h=u.getCoordinates(),h[c.index+f]=e,g[f]=e;break;case"MultiLineString":case"Polygon":h=u.getCoordinates(),h[p[0]][c.index+f]=e,g[f]=e;break;case"MultiPolygon":h=u.getCoordinates(),h[p[1]][p[0]][c.index+f]=e,g[f]=e;break;case"Circle":if(g[0]=e,g[1]=e,0===c.index)this.changingFeature_=!0,u.setCenter(e),this.changingFeature_=!1;else{this.changingFeature_=!0;const C=t.map.getView().getProjection();let b=(0,P.TE)((0,y.Vs)(u.getCenter(),C),(0,y.Vs)(e,C));const F=(0,y.Cs)();if(F){const E=u.clone().transform(F,C);E.setRadius(b),b=E.transform(C,F).getRadius()}u.setRadius(b),this.changingFeature_=!1}}h&&this.setGeometryCoordinates_(u,h)}this.createOrUpdateVertexFeature_(e,i,r)}handleDownEvent(t){if(!this.condition_(t))return!1;const e=t.coordinate;this.handlePointerAtPixel_(t.pixel,t.map,e),this.dragSegments_.length=0,this.featuresBeingModified_=null;const i=this.vertexFeature_;if(i){const r=t.map.getView().getProjection(),s=[],a=i.getGeometry().getCoordinates(),l=(0,x.hI)([a]),c=this.rBush_.getInExtent(l),d={};c.sort(xn);for(let u=0,p=c.length;u<p;++u){const h=c[u],g=h.segment;let f=(0,T.sq)(h.geometry);const C=h.depth;if(C&&(f+="-"+C.join("-")),d[f]||(d[f]=new Array(2)),"Circle"!==h.geometry.getType()||h.index!==ee)if(!(0,P.fS)(g[0],a)||d[f][0])if(!(0,P.fS)(g[1],a)||d[f][1])(0,T.sq)(g)in this.vertexSegments_&&!d[f][0]&&!d[f][1]&&this.insertVertexCondition_(t)&&s.push(h);else{if(d[f][0]&&0===d[f][0].index){let b=h.geometry.getCoordinates();switch(h.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":b=b[C[1]];case"Polygon":if(h.index!==b[C[0]].length-2)continue}}this.dragSegments_.push([h,1]),d[f][1]=h}else this.dragSegments_.push([h,0]),d[f][0]=h;else{const b=gt(e,h,r);(0,P.fS)(b,a)&&!d[f][0]&&(this.dragSegments_.push([h,0]),d[f][0]=h)}}s.length&&this.willModifyFeatures_(t,[s]);for(let u=s.length-1;u>=0;--u)this.insertVertex_(s[u],a)}return!!this.vertexFeature_}handleUpEvent(t){for(let e=this.dragSegments_.length-1;e>=0;--e){const i=this.dragSegments_[e][0],r=i.geometry;if("Circle"===r.getType()){const s=r.getCenter(),a=i.featureSegments[0],l=i.featureSegments[1];a.segment[0]=s,a.segment[1]=s,l.segment[0]=s,l.segment[1]=s,this.rBush_.update((0,x.HK)(s),a);let c=r;const d=(0,y.Cs)();if(d){const u=t.map.getView().getProjection();c=c.clone().transform(d,u),c=(0,G.Bb)(c).transform(u,d)}this.rBush_.update(c.getExtent(),l)}else this.rBush_.update((0,x.hI)(i.segment),i)}return this.featuresBeingModified_&&(this.dispatchEvent(new Be("modifyend",this.featuresBeingModified_,t)),this.featuresBeingModified_=null),!1}handlePointerMove_(t){this.lastPixel_=t.pixel,this.handlePointerAtPixel_(t.pixel,t.map,t.coordinate)}handlePointerAtPixel_(t,e,i){const r=i||e.getCoordinateFromPixel(t),s=e.getView().getProjection(),a=function(d,u){return ht(r,d,s)-ht(r,u,s)};let l,c;if(this.hitDetection_&&e.forEachFeatureAtPixel(t,(u,p,h)=>{const g=h||u.getGeometry();if("Point"===g.getType()&&u instanceof S.Z&&this.features_.getArray().includes(u)){c=g;const f=c.getFlatCoordinates().slice(0,2);l=[{feature:u,geometry:c,segment:[f,f]}]}return!0},{layerFilter:"object"==typeof this.hitDetection_?u=>u===this.hitDetection_:void 0}),!l){const d=(0,y.dY)((0,x.HK)(r,ut),s),u=e.getView().getResolution()*this.pixelTolerance_,p=(0,y.Fj)((0,x.f3)(d,u,ut),s);l=this.rBush_.getInExtent(p)}if(l&&l.length>0){const d=l.sort(a)[0],u=d.segment;let p=gt(r,d,s);const h=e.getPixelFromCoordinate(p);let g=(0,P.TE)(t,h);if(c||g<=this.pixelTolerance_){const f={};if(f[(0,T.sq)(u)]=!0,this.snapToPointer_||(this.delta_[0]=p[0]-r[0],this.delta_[1]=p[1]-r[1]),"Circle"===d.geometry.getType()&&d.index===ee)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(p,[d.feature],[d.geometry]);else{const C=e.getPixelFromCoordinate(u[0]),b=e.getPixelFromCoordinate(u[1]),F=(0,P.bI)(h,C),E=(0,P.bI)(h,b);g=Math.sqrt(Math.min(F,E)),this.snappedToVertex_=g<=this.pixelTolerance_,this.snappedToVertex_&&(p=F>E?u[1]:u[0]),this.createOrUpdateVertexFeature_(p,[d.feature],[d.geometry]);const U={};U[(0,T.sq)(d.geometry)]=!0;for(let Ee=1,hr=l.length;Ee<hr;++Ee){const te=l[Ee].segment;if(!((0,P.fS)(u[0],te[0])&&(0,P.fS)(u[1],te[1])||(0,P.fS)(u[0],te[1])&&(0,P.fS)(u[1],te[0])))break;{const Et=(0,T.sq)(l[Ee].geometry);Et in U||(U[Et]=!0,f[(0,T.sq)(te)]=!0)}}}return void(this.vertexSegments_=f)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(t,e){const i=t.segment,r=t.feature,s=t.geometry,a=t.depth,l=t.index;let c;for(;e.length<s.getStride();)e.push(0);switch(s.getType()){case"MultiLineString":case"Polygon":c=s.getCoordinates(),c[a[0]].splice(l+1,0,e);break;case"MultiPolygon":c=s.getCoordinates(),c[a[1]][a[0]].splice(l+1,0,e);break;case"LineString":c=s.getCoordinates(),c.splice(l+1,0,e);break;default:return}this.setGeometryCoordinates_(s,c);const d=this.rBush_;d.remove(t),this.updateSegmentIndices_(s,l,a,1);const u={segment:[i[0],e],feature:r,geometry:s,depth:a,index:l};d.insert((0,x.hI)(u.segment),u),this.dragSegments_.push([u,1]);const p={segment:[e,i[1]],feature:r,geometry:s,depth:a,index:l+1};d.insert((0,x.hI)(p.segment),p),this.dragSegments_.push([p,0]),this.ignoreNextSingleClick_=!0}removePoint(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=Z.Z.POINTERDRAG){const t=this.lastPointerEvent_;this.willModifyFeatures_(t,this.dragSegments_);const e=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new Be("modifyend",this.featuresBeingModified_,t)),this.featuresBeingModified_=null,e}return!1}removeVertex_(){const t=this.dragSegments_,e={};let r,s,a,l,c,d,u,p,h,g,f,i=!1;for(c=t.length-1;c>=0;--c)a=t[c],g=a[0],f=(0,T.sq)(g.feature),g.depth&&(f+="-"+g.depth.join("-")),f in e||(e[f]={}),0===a[1]?(e[f].right=g,e[f].index=g.index):1==a[1]&&(e[f].left=g,e[f].index=g.index+1);for(f in e){switch(h=e[f].right,u=e[f].left,d=e[f].index,p=d-1,g=void 0!==u?u:h,p<0&&(p=0),l=g.geometry,s=l.getCoordinates(),r=s,i=!1,l.getType()){case"MultiLineString":s[g.depth[0]].length>2&&(s[g.depth[0]].splice(d,1),i=!0);break;case"LineString":s.length>2&&(s.splice(d,1),i=!0);break;case"MultiPolygon":r=r[g.depth[1]];case"Polygon":r=r[g.depth[0]],r.length>4&&(d==r.length-1&&(d=0),r.splice(d,1),i=!0,0===d&&(r.pop(),r.push(r[0]),p=r.length-1))}if(i){this.setGeometryCoordinates_(l,s);const C=[];if(void 0!==u&&(this.rBush_.remove(u),C.push(u.segment[0])),void 0!==h&&(this.rBush_.remove(h),C.push(h.segment[1])),void 0!==u&&void 0!==h){const b={depth:g.depth,feature:g.feature,geometry:g.geometry,index:p,segment:C};this.rBush_.insert((0,x.hI)(b.segment),b)}this.updateSegmentIndices_(l,d,g.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.length=0}}return i}setGeometryCoordinates_(t,e){this.changingFeature_=!0,t.setCoordinates(e),this.changingFeature_=!1}updateSegmentIndices_(t,e,i,r){this.rBush_.forEachInExtent(t.getExtent(),function(s){s.geometry===t&&(void 0===i||void 0===s.depth||(0,D.fS)(s.depth,i))&&s.index>e&&(s.index+=r)})}};var pt=m(874);class _e extends B.ZP{constructor(t,e,i){super(),void 0!==i&&void 0===e?this.setFlatCoordinates(i,t):this.setCenterAndRadius(t,e=e||0,i)}clone(){const t=new _e(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){const s=this.flatCoordinates,a=t-s[0],l=e-s[1],c=a*a+l*l;if(c<r){if(0===c)for(let d=0;d<this.stride;++d)i[d]=s[d];else{const d=this.getRadius()/Math.sqrt(c);i[0]=s[0]+d*a,i[1]=s[1]+d*l;for(let u=2;u<this.stride;++u)i[u]=s[u]}return i.length=this.stride,c}return r}containsXY(t,e){const i=this.flatCoordinates,r=t-i[0],s=e-i[1];return r*r+s*s<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(t){const e=this.flatCoordinates,i=e[this.stride]-e[0];return(0,x.T9)(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e}getType(){return"Circle"}intersectsExtent(t){const e=this.getExtent();if((0,x.kK)(t,e)){const i=this.getCenter();return t[0]<=i[0]&&t[2]>=i[0]||t[1]<=i[1]&&t[3]>=i[1]||(0,x.H6)(t,this.intersectsCoordinate.bind(this))}return!1}setCenter(t){const e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],r=t.slice();r[e]=r[0]+i;for(let s=1;s<e;++s)r[e+s]=t[s];this.setFlatCoordinates(this.layout,r),this.changed()}setCenterAndRadius(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);const r=this.flatCoordinates;let s=(0,ae.IG)(r,0,t,this.stride);r[s++]=r[0]+e;for(let a=1,l=this.stride;a<l;++a)r[s++]=r[a];r.length=s,this.changed()}getCoordinates(){return null}setCoordinates(t,e){}setRadius(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()}rotate(t,e){const i=this.getCenter(),r=this.getStride();this.setCenter((0,pt.U1)(i,0,i.length,r,t,e,i)),this.changed()}translate(t,e){const i=this.getCenter(),r=this.getStride();this.setCenter((0,pt.Iu)(i,0,i.length,r,t,e,i)),this.changed()}}const bn=_e;var wn=m(1994);class Ce extends Je.ZP{constructor(t,e){super(t),this.feature=e}}function xe(o,t){return(0,X.bI)(o[0],o[1],t[0],t[1])}function H(o,t){const e=o.length;return t<0?o[t+e]:t>=e?o[t-e]:o[t]}function Te(o,t,e){let i,r;t<e?(i=t,r=e):(i=e,r=t);const s=Math.ceil(i),a=Math.floor(r);if(s>a)return xe(V(o,i),V(o,r));let l=0;i<s&&(l+=xe(V(o,i),H(o,s))),a<r&&(l+=xe(H(o,a),V(o,r)));for(let c=s;c<a-1;++c)l+=xe(H(o,c),H(o,c+1));return l}function ft(o,t,e){if(t instanceof O.Z)ve(o,t.getCoordinates(),!1,e);else if(t instanceof ce){const i=t.getCoordinates();for(let r=0,s=i.length;r<s;++r)ve(o,i[r],!1,e)}else if(t instanceof G.ZP){const i=t.getCoordinates();for(let r=0,s=i.length;r<s;++r)ve(o,i[r],!0,e)}else if(t instanceof he){const i=t.getCoordinates();for(let r=0,s=i.length;r<s;++r){const a=i[r];for(let l=0,c=a.length;l<c;++l)ve(o,a[l],!0,e)}}else if(t instanceof W){const i=t.getGeometries();for(let r=0;r<i.length;++r)ft(o,i[r],e)}}const Qe={index:-1,endIndex:NaN};function ve(o,t,e,i){const r=o[0],s=o[1];for(let a=0,l=t.length-1;a<l;++a){const u=mt(r,s,t[a],t[a+1]);if(0===u.squaredDistance){const p=a+u.along;return void i.push({coordinates:t,ring:e,startIndex:p,endIndex:p})}}}const qe={along:0,squaredDistance:0};function mt(o,t,e,i){const r=e[0],s=e[1],c=i[0]-r,d=i[1]-s;let u=0,p=r,h=s;return(0!==c||0!==d)&&(u=(0,X.uZ)(((o-r)*c+(t-s)*d)/(c*c+d*d),0,1),p+=c*u,h+=d*u),qe.along=u,qe.squaredDistance=(0,X.FH)((0,X.bI)(o,t,p,h),10),qe}function V(o,t){const e=o.length;let i=Math.floor(t);const r=t-i;i>=e?i-=e:i<0&&(i+=e);let s=i+1;s>=e&&(s-=e);const a=o[i],l=a[0],c=a[1],d=o[s];return[l+(d[0]-l)*r,c+(d[1]-c)*r]}function En(){const o=(0,J.Ly)();return function(t,e){return o[t.getGeometry().getType()]}}const Sn=class Ln extends fe.Z{constructor(t){const e=t;e.stopDown||(e.stopDown=Q.Dv),super(e),this.shouldHandle_=!1,this.downPx_=null,this.freehand_=!1,this.source_=t.source?t.source:null,this.features_=t.features?t.features:null,this.snapTolerance_=t.snapTolerance?t.snapTolerance:12,this.type_=t.type,this.mode_=function In(o){switch(o){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+o)}}(this.type_),this.stopClick_=!!t.stopClick,this.minPoints_=t.minPoints?t.minPoints:"Polygon"===this.mode_?3:2,this.maxPoints_="Circle"===this.mode_?2:t.maxPoints?t.maxPoints:1/0,this.finishCondition_=t.finishCondition?t.finishCondition:Q.uX,this.geometryLayout_=t.geometryLayout?t.geometryLayout:"XY";let i=t.geometryFunction;if(!i){const r=this.mode_;if("Circle"===r)i=function(s,a,l){const c=a||new bn([NaN,NaN]),d=(0,y.Vs)(s[0],l),u=(0,P.bI)(d,(0,y.Vs)(s[s.length-1],l));c.setCenterAndRadius(d,Math.sqrt(u),this.geometryLayout_);const p=(0,y.Cs)();return p&&c.transform(l,p),c};else{let s;"Point"===r?s=N.Z:"LineString"===r?s=O.Z:"Polygon"===r&&(s=G.ZP),i=function(a,l,c){return l?l.setCoordinates("Polygon"===r?a[0].length?[a[0].concat([a[0][0]])]:[]:a,this.geometryLayout_):l=new s(a,this.geometryLayout_),l}}}this.geometryFunction_=i,this.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.overlay_=new Ne.Z({source:new z.Z({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:En(),updateWhileInteracting:!0}),this.geometryName_=t.geometryName,this.condition_=t.condition?t.condition:k.rM,this.freehandCondition_=t.freehand?k.Bx:t.freehandCondition?t.freehandCondition:k.vY,this.setTrace(t.trace||!1),this.traceState_={active:!1},this.traceSource_=t.traceSource||t.source||null,this.addChangeListener(ct.Z.ACTIVE,this.updateState_)}setTrace(t){let e;e=t?!0===t?k.Bx:t:k.Fi,this.traceCondition_=e}setMap(t){super.setMap(t),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(t){t.originalEvent.type===K.Z.CONTEXTMENU&&t.originalEvent.preventDefault(),this.freehand_="Point"!==this.mode_&&this.freehandCondition_(t);let e=t.type===Z.Z.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&t.type===Z.Z.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===Z.Z.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t.coordinate),i=!1):this.freehand_&&t.type===Z.Z.POINTERDOWN?i=!1:e&&this.getPointerCount()<2?(i=t.type===Z.Z.POINTERMOVE,i&&this.freehand_?(this.handlePointerMove_(t),this.shouldHandle_&&t.originalEvent.preventDefault()):("mouse"===t.originalEvent.pointerType||t.type===Z.Z.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(t)):t.type===Z.Z.DBLCLICK&&(i=!1),super.handleEvent(t)&&i}handleDownEvent(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t.coordinate),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new wn.Z(Z.Z.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))},this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(t){if(!this.traceSource_||!this.traceCondition_(t))return;if(this.traceState_.active)return void this.deactivateTrace_();const e=this.getMap(),i=e.getCoordinateFromPixel([t.pixel[0]-this.snapTolerance_,t.pixel[1]+this.snapTolerance_]),r=e.getCoordinateFromPixel([t.pixel[0]+this.snapTolerance_,t.pixel[1]-this.snapTolerance_]),s=(0,x.hI)([i,r]),a=this.traceSource_.getFeaturesInExtent(s);if(0===a.length)return;const l=function Pn(o,t){const e=[];for(let i=0;i<t.length;++i)ft(o,t[i].getGeometry(),e);return e}(t.coordinate,a);l.length&&(this.traceState_={active:!0,startPx:t.pixel.slice(),targets:l,targetIndex:-1})}addOrRemoveTracedCoordinates_(t,e){const i=t.startIndex<=t.endIndex;i===t.startIndex<=e?i&&e>t.endIndex||!i&&e<t.endIndex?this.addTracedCoordinates_(t,t.endIndex,e):(i&&e<t.endIndex||!i&&e>t.endIndex)&&this.removeTracedCoordinates_(e,t.endIndex):(this.removeTracedCoordinates_(t.startIndex,t.endIndex),this.addTracedCoordinates_(t,t.startIndex,e))}removeTracedCoordinates_(t,e){if(t===e)return;let i=0;if(t<e){const r=Math.ceil(t);let s=Math.floor(e);s===e&&(s-=1),i=s-r+1}else{const r=Math.floor(t);let s=Math.ceil(e);s===e&&(s+=1),i=r-s+1}i>0&&this.removeLastPoints_(i)}addTracedCoordinates_(t,e,i){if(e===i)return;const r=[];if(e<i){const s=Math.ceil(e);let a=Math.floor(i);a===i&&(a-=1);for(let l=s;l<=a;++l)r.push(H(t.coordinates,l))}else{const s=Math.floor(e);let a=Math.ceil(i);a===i&&(a+=1);for(let l=s;l>=a;--l)r.push(H(t.coordinates,l))}r.length&&this.appendCoordinates(r)}updateTrace_(t){const e=this.traceState_;if(!e.active||-1===e.targetIndex&&(0,P.TE)(e.startPx,t.pixel)<this.snapTolerance_)return;const i=function Fn(o,t,e,i){const r=o[0],s=o[1];let a=1/0,l=-1,c=NaN;for(let p=0;p<t.targets.length;++p){const h=t.targets[p],g=h.coordinates;let C,f=1/0;for(let b=0;b<g.length-1;++b){const U=mt(r,s,g[b],g[b+1]);U.squaredDistance<f&&(f=U.squaredDistance,C=b+U.along)}f<a&&(a=f,h.ring&&t.targetIndex===p&&(h.endIndex>h.startIndex?C<h.startIndex&&(C+=g.length):h.endIndex<h.startIndex&&C>h.startIndex&&(C-=g.length)),c=C,l=p)}const d=t.targets[l];let u=d.ring;if(t.targetIndex===l&&u){const p=V(d.coordinates,c),h=e.getPixelFromCoordinate(p);(0,P.TE)(h,t.startPx)>i&&(u=!1)}if(u){const p=d.coordinates,h=p.length,g=d.startIndex,f=c;if(g<f){const C=Te(p,g,f);Te(p,g,f-h)<C&&(c-=h)}else{const C=Te(p,g,f);Te(p,g,f+h)<C&&(c+=h)}}return Qe.index=l,Qe.endIndex=c,Qe}(t.coordinate,e,this.getMap(),this.snapTolerance_);if(e.targetIndex!==i.index){if(-1!==e.targetIndex){const c=e.targets[e.targetIndex];this.removeTracedCoordinates_(c.startIndex,c.endIndex)}const l=e.targets[i.index];this.addTracedCoordinates_(l,l.startIndex,i.endIndex)}else this.addOrRemoveTracedCoordinates_(e.targets[e.targetIndex],i.endIndex);e.targetIndex=i.index;const r=e.targets[e.targetIndex];r.endIndex=i.endIndex;const s=V(r.coordinates,r.endIndex),a=this.getMap().getPixelFromCoordinate(s);t.coordinate=s,t.pixel=[Math.round(a[0]),Math.round(a[1])]}handleUpEvent(t){let e=!0;if(0===this.getPointerCount()){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);const i=this.traceState_.active;if(this.toggleTraceState_(t),this.shouldHandle_){const r=!this.finishCoordinate_;r&&this.startDrawing_(t.coordinate),!r&&this.freehand_?this.finishDrawing():!this.freehand_&&(!r||"Point"===this.mode_)&&(this.atFinish_(t.pixel,i)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate)),e=!1}else this.freehand_&&this.abortDrawing()}return!e&&this.stopClick_&&t.preventDefault(),e}handlePointerMove_(t){if(this.pointerType_=t.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const e=this.downPx_,i=t.pixel,r=e[0]-i[0],s=e[1]-i[1],a=r*r+s*s;if(this.shouldHandle_=this.freehand_?a>this.squaredClickTolerance_:a<=this.squaredClickTolerance_,!this.shouldHandle_)return}this.finishCoordinate_?(this.updateTrace_(t),this.modifyDrawing_(t.coordinate)):this.createOrUpdateSketchPoint_(t.coordinate.slice())}atFinish_(t,e){let i=!1;if(this.sketchFeature_){let r=!1,s=[this.finishCoordinate_];const a=this.mode_;if("Point"===a)i=!0;else if("Circle"===a)i=2===this.sketchCoords_.length;else if("LineString"===a)r=!e&&this.sketchCoords_.length>this.minPoints_;else if("Polygon"===a){const l=this.sketchCoords_;r=l[0].length>this.minPoints_,s=[l[0][0],l[0][l[0].length-2]],s=e?[l[0][0]]:[l[0][0],l[0][l[0].length-2]]}if(r){const l=this.getMap();for(let c=0,d=s.length;c<d;c++){const u=s[c],p=l.getPixelFromCoordinate(u),h=t[0]-p[0],g=t[1]-p[1],f=this.freehand_?1:this.snapTolerance_;if(i=Math.sqrt(h*h+g*g)<=f,i){this.finishCoordinate_=u;break}}}}return i}createOrUpdateSketchPoint_(t){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new S.Z(new N.Z(t)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(t){this.sketchLine_||(this.sketchLine_=new S.Z);const e=t.getLinearRing(0);let i=this.sketchLine_.getGeometry();i?(i.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),i.changed()):(i=new O.Z(e.getFlatCoordinates(),e.getLayout()),this.sketchLine_.setGeometry(i))}startDrawing_(t){const e=this.getMap().getView().getProjection(),i=(0,B.tP)(this.geometryLayout_);for(;t.length<i;)t.push(0);this.finishCoordinate_=t,"Point"===this.mode_?this.sketchCoords_=t.slice():"Polygon"===this.mode_?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new S.Z(new O.Z(this.sketchLineCoords_)));const r=this.geometryFunction_(this.sketchCoords_,void 0,e);this.sketchFeature_=new S.Z,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(r),this.updateSketchFeatures_(),this.dispatchEvent(new Ce("drawstart",this.sketchFeature_))}modifyDrawing_(t){const e=this.getMap(),i=this.sketchFeature_.getGeometry(),r=e.getView().getProjection(),s=(0,B.tP)(this.geometryLayout_);let a,l;for(;t.length<s;)t.push(0);"Point"===this.mode_?l=this.sketchCoords_:"Polygon"===this.mode_?(a=this.sketchCoords_[0],l=a[a.length-1],this.atFinish_(e.getPixelFromCoordinate(t))&&(t=this.finishCoordinate_.slice())):(a=this.sketchCoords_,l=a[a.length-1]),l[0]=t[0],l[1]=t[1],this.geometryFunction_(this.sketchCoords_,i,r),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(t),"Polygon"===i.getType()&&"Polygon"!==this.mode_?this.createOrUpdateCustomSketchLine_(i):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(t){const e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection();let r,s;const a=this.mode_;"LineString"===a||"Circle"===a?(this.finishCoordinate_=t.slice(),s=this.sketchCoords_,s.length>=this.maxPoints_&&(this.freehand_?s.pop():r=!0),s.push(t.slice()),this.geometryFunction_(s,e,i)):"Polygon"===a&&(s=this.sketchCoords_[0],s.length>=this.maxPoints_&&(this.freehand_?s.pop():r=!0),s.push(t.slice()),r&&(this.finishCoordinate_=s[0]),this.geometryFunction_(this.sketchCoords_,e,i)),this.createOrUpdateSketchPoint_(t.slice()),this.updateSketchFeatures_(),r&&this.finishDrawing()}removeLastPoints_(t){if(!this.sketchFeature_)return;const e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),r=this.mode_;for(let s=0;s<t;++s){let a;if("LineString"===r||"Circle"===r){if(a=this.sketchCoords_,a.splice(-2,1),a.length>=2){this.finishCoordinate_=a[a.length-2].slice();const l=this.finishCoordinate_.slice();a[a.length-1]=l,this.createOrUpdateSketchPoint_(l)}this.geometryFunction_(a,e,i),"Polygon"===e.getType()&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if("Polygon"===r){a=this.sketchCoords_[0],a.splice(-2,1);const l=this.sketchLine_.getGeometry();if(a.length>=2){const c=a[a.length-2].slice();a[a.length-1]=c,this.createOrUpdateSketchPoint_(c)}l.setCoordinates(a),this.geometryFunction_(this.sketchCoords_,e,i)}if(1===a.length){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const t=this.abortDrawing_();if(!t)return;let e=this.sketchCoords_;const i=t.getGeometry(),r=this.getMap().getView().getProjection();"LineString"===this.mode_?(e.pop(),this.geometryFunction_(e,i,r)):"Polygon"===this.mode_&&(e[0].pop(),this.geometryFunction_(e,i,r),e=i.getCoordinates()),"MultiPoint"===this.type_?t.setGeometry(new de([e])):"MultiLineString"===this.type_?t.setGeometry(new ce([e])):"MultiPolygon"===this.type_&&t.setGeometry(new he([e])),this.dispatchEvent(new Ce("drawend",t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}abortDrawing_(){this.finishCoordinate_=null;const t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),t}abortDrawing(){const t=this.abortDrawing_();t&&this.dispatchEvent(new Ce("drawabort",t))}appendCoordinates(t){const e=this.mode_,i=!this.sketchFeature_;let r;if(i&&this.startDrawing_(t[0]),"LineString"===e||"Circle"===e)r=this.sketchCoords_;else{if("Polygon"!==e)return;r=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}i&&r.shift(),r.pop();for(let a=0;a<t.length;a++)this.addToDrawing_(t[a]);const s=t[t.length-1];this.addToDrawing_(s),this.modifyDrawing_(s)}extend(t){const i=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=i.getCoordinates();const r=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=r.slice(),this.sketchCoords_.push(r.slice()),this.sketchPoint_=new S.Z(new N.Z(r)),this.updateSketchFeatures_(),this.dispatchEvent(new Ce("drawstart",this.sketchFeature_))}updateSketchFeatures_(){const t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);const e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)}updateState_(){const t=this.getMap(),e=this.getActive();(!t||!e)&&this.abortDrawing(),this.overlay_.setMap(e?t:null)}};function be(o){return"string"==typeof o?o:""}const kn=class Mn extends ze{constructor(){super()}getType(){return"text"}readFeature(t,e){return this.readFeatureFromText(be(t),this.adaptOptions(e))}readFeatureFromText(t,e){return(0,T.O3)()}readFeatures(t,e){return this.readFeaturesFromText(be(t),this.adaptOptions(e))}readFeaturesFromText(t,e){return(0,T.O3)()}readGeometry(t,e){return this.readGeometryFromText(be(t),this.adaptOptions(e))}readGeometryFromText(t,e){return(0,T.O3)()}readProjection(t){return this.readProjectionFromText(be(t))}readProjectionFromText(t){return this.dataProjection}writeFeature(t,e){return this.writeFeatureText(t,this.adaptOptions(e))}writeFeatureText(t,e){return(0,T.O3)()}writeFeatures(t,e){return this.writeFeaturesText(t,this.adaptOptions(e))}writeFeaturesText(t,e){return(0,T.O3)()}writeGeometry(t,e){return this.writeGeometryText(t,this.adaptOptions(e))}writeGeometryText(t,e){return(0,T.O3)()}},Zn={POINT:N.Z,LINESTRING:O.Z,POLYGON:G.ZP,MULTIPOINT:de,MULTILINESTRING:ce,MULTIPOLYGON:he},_t="EMPTY",yt="Z",Ct="M",An={Point:"POINT",LineString:"LINESTRING",Polygon:"POLYGON",MultiPoint:"MULTIPOINT",MultiLineString:"MULTILINESTRING",MultiPolygon:"MULTIPOLYGON",GeometryCollection:"GEOMETRYCOLLECTION",Circle:"CIRCLE"};class On{constructor(t){this.wkt=t,this.index_=-1}isAlpha_(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"}isNumeric_(t,e){return e=void 0!==e&&e,t>="0"&&t<="9"||"."==t&&!e}isWhiteSpace_(t){return" "==t||"\t"==t||"\r"==t||"\n"==t}nextChar_(){return this.wkt.charAt(++this.index_)}nextToken(){const t=this.nextChar_(),e=this.index_;let r,i=t;if("("==t)r=2;else if(","==t)r=5;else if(")"==t)r=3;else if(this.isNumeric_(t)||"-"==t)r=4,i=this.readNumber_();else if(this.isAlpha_(t))r=1,i=this.readText_();else{if(this.isWhiteSpace_(t))return this.nextToken();if(""!==t)throw new Error("Unexpected character: "+t);r=6}return{position:e,value:i,type:r}}readNumber_(){let t;const e=this.index_;let i=!1,r=!1;do{"."==t?i=!0:("e"==t||"E"==t)&&(r=!0),t=this.nextChar_()}while(this.isNumeric_(t,i)||!r&&("e"==t||"E"==t)||r&&("-"==t||"+"==t));return parseFloat(this.wkt.substring(e,this.index_--))}readText_(){let t;const e=this.index_;do{t=this.nextChar_()}while(this.isAlpha_(t));return this.wkt.substring(e,this.index_--).toUpperCase()}}class Nn{constructor(t){this.lexer_=t,this.token_={position:0,type:0},this.layout_="XY"}consume_(){this.token_=this.lexer_.nextToken()}isTokenType(t){return this.token_.type==t}match(t){const e=this.isTokenType(t);return e&&this.consume_(),e}parse(){return this.consume_(),this.parseGeometry_()}parseGeometryLayout_(){let t="XY";const e=this.token_;if(this.isTokenType(1)){const i=e.value;i===yt?t="XYZ":i===Ct?t="XYM":"ZM"===i&&(t="XYZM"),"XY"!==t&&this.consume_()}return t}parseGeometryCollectionText_(){if(this.match(2)){const t=[];do{t.push(this.parseGeometry_())}while(this.match(5));if(this.match(3))return t}throw new Error(this.formatErrorMessage_())}parsePointText_(){if(this.match(2)){const t=this.parsePoint_();if(this.match(3))return t}throw new Error(this.formatErrorMessage_())}parseLineStringText_(){if(this.match(2)){const t=this.parsePointList_();if(this.match(3))return t}throw new Error(this.formatErrorMessage_())}parsePolygonText_(){if(this.match(2)){const t=this.parseLineStringTextList_();if(this.match(3))return t}throw new Error(this.formatErrorMessage_())}parseMultiPointText_(){if(this.match(2)){let t;if(t=2==this.token_.type?this.parsePointTextList_():this.parsePointList_(),this.match(3))return t}throw new Error(this.formatErrorMessage_())}parseMultiLineStringText_(){if(this.match(2)){const t=this.parseLineStringTextList_();if(this.match(3))return t}throw new Error(this.formatErrorMessage_())}parseMultiPolygonText_(){if(this.match(2)){const t=this.parsePolygonTextList_();if(this.match(3))return t}throw new Error(this.formatErrorMessage_())}parsePoint_(){const t=[],e=this.layout_.length;for(let i=0;i<e;++i){const r=this.token_;if(!this.match(4))break;t.push(r.value)}if(t.length==e)return t;throw new Error(this.formatErrorMessage_())}parsePointList_(){const t=[this.parsePoint_()];for(;this.match(5);)t.push(this.parsePoint_());return t}parsePointTextList_(){const t=[this.parsePointText_()];for(;this.match(5);)t.push(this.parsePointText_());return t}parseLineStringTextList_(){const t=[this.parseLineStringText_()];for(;this.match(5);)t.push(this.parseLineStringText_());return t}parsePolygonTextList_(){const t=[this.parsePolygonText_()];for(;this.match(5);)t.push(this.parsePolygonText_());return t}isEmptyGeometry_(){const t=this.isTokenType(1)&&this.token_.value==_t;return t&&this.consume_(),t}formatErrorMessage_(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}parseGeometry_(){const t=this.token_;if(this.match(1)){const e=t.value;this.layout_=this.parseGeometryLayout_();const i=this.isEmptyGeometry_();if("GEOMETRYCOLLECTION"==e){if(i)return new W([]);const a=this.parseGeometryCollectionText_();return new W(a)}const r=Zn[e];if(!r)throw new Error("Invalid geometry type: "+e);let s;if(i)s="POINT"==e?[NaN,NaN]:[];else switch(e){case"POINT":s=this.parsePointText_();break;case"LINESTRING":s=this.parseLineStringText_();break;case"POLYGON":s=this.parsePolygonText_();break;case"MULTIPOINT":s=this.parseMultiPointText_();break;case"MULTILINESTRING":s=this.parseMultiLineStringText_();break;case"MULTIPOLYGON":s=this.parseMultiPolygonText_()}return new r(s,this.layout_)}throw new Error(this.formatErrorMessage_())}}function xt(o){const t=o.getCoordinates();return 0===t.length?"":t.join(" ")}function He(o){const t=o.getCoordinates(),e=[];for(let i=0,r=t.length;i<r;++i)e.push(t[i].join(" "));return e.join(",")}function Tt(o){const t=[],e=o.getLinearRings();for(let i=0,r=e.length;i<r;++i)t.push("("+He(e[i])+")");return t.join(",")}const Qn={Point:xt,LineString:He,Polygon:Tt,MultiPoint:function Jn(o){const t=[],e=o.getPoints();for(let i=0,r=e.length;i<r;++i)t.push("("+xt(e[i])+")");return t.join(",")},MultiLineString:function jn(o){const t=[],e=o.getLineStrings();for(let i=0,r=e.length;i<r;++i)t.push("("+He(e[i])+")");return t.join(",")},MultiPolygon:function Un(o){const t=[],e=o.getPolygons();for(let i=0,r=e.length;i<r;++i)t.push("("+Tt(e[i])+")");return t.join(",")},GeometryCollection:function Rn(o){const t=[],e=o.getGeometries();for(let i=0,r=e.length;i<r;++i)t.push(vt(e[i]));return t.join(",")}};function vt(o){const t=o.getType(),i=(0,Qn[t])(o);let r=An[t];if("function"==typeof o.getFlatCoordinates){const s=function Bn(o){const t=o.getLayout();let e="";return("XYZ"===t||"XYZM"===t)&&(e+=yt),("XYM"===t||"XYZM"===t)&&(e+=Ct),e}(o);s.length>0&&(r+=" "+s)}return 0===i.length?r+" "+_t:r+"("+i+")"}const bt=class Dn extends kn{constructor(t){super(),this.splitCollection_=void 0!==(t=t||{}).splitCollection&&t.splitCollection}parse_(t){const e=new On(t);return new Nn(e).parse()}readFeatureFromText(t,e){const i=this.readGeometryFromText(t,e),r=new S.Z;return r.setGeometry(i),r}readFeaturesFromText(t,e){let i=[];const r=this.readGeometryFromText(t,e);i=this.splitCollection_&&"GeometryCollection"==r.getType()?r.getGeometriesArray():[r];const s=[];for(let a=0,l=i.length;a<l;++a){const c=new S.Z;c.setGeometry(i[a]),s.push(c)}return s}readGeometryFromText(t,e){return re(this.parse_(t),!1,e)}writeFeatureText(t,e){const i=t.getGeometry();return i?this.writeGeometryText(i,e):""}writeFeaturesText(t,e){if(1==t.length)return this.writeFeatureText(t[0],e);const i=[];for(let s=0,a=t.length;s<a;++s)i.push(t[s].getGeometry());const r=new W(i);return this.writeGeometryText(r,e)}writeGeometryText(t,e){return vt(re(t,!0,e))}};var we=m(5044),Pe=m(6785),qn=m(7392);class Hn{constructor(t,e,i,r=null){this._fillColor=function cn(){const o=ln;return o[Math.floor(Math.random()*o.length)]}(),this._strokeColor="black",this._strokeWidth="2",this._locked=!1,this._featuresToggled=!1,this._featuresCounter=0,this._initLayer(t,e,i)}get layer(){return this._vectorLayer}get layerName(){return this._getLayerAttributes("name")}set layerName(t){this.layer.set("name",t)}get geomType(){return this._getLayerAttributes("geom_type")}get sourceFeatures(){return this._sourceFeatures}get zIndex(){return this.layer.getZIndex()}set zIndex(t){this.layer.setZIndex(t)}get uuid(){return this._getLayerAttributes("uuid")}set visible(t){this.layer.setVisible(t)}get visible(){return this.layer.getVisible()}set featuresToggled(t){this._featuresToggled=t}get featuresToggled(){return this._featuresToggled}set locked(t){this._locked=t}get locked(){return this._locked}set opacity(t){this.layer.setOpacity(t.target.valueAsNumber)}get opacity(){return this.layer.getOpacity()}get fillColor(){return this._fillColor}set fillColor(t){ot.test(t)&&(this.features.forEach(e=>{e.set("fill_color",t,!1)}),this._fillColor=t)}get strokeColor(){return this._strokeColor}set strokeColor(t){ot.test(t)&&(this.features.forEach(e=>{e.set("stroke_color",t,!1)}),this._strokeColor=t)}get strokeWidth(){return this._strokeWidth}set strokeWidth(t){this._strokeWidth=t,this.features.forEach(e=>{e.set("stroke_width",parseFloat(t),!1)})}_initLayer(t,e,i){this._sourceFeatures=new z.Z,this._vectorLayer=new Ne.Z({source:this._sourceFeatures,style:(r,s)=>Pt(r)}),this.layerName=t,this.layer.set("uuid",st()),this.layer.set("geom_type",e),this.zIndex=i}_getLayerAttributes(t){return this.layer.get(t)}get features(){return this._sourceFeatures.getFeatures().sort((t,e)=>t.get("no")-e.get("no"))}featureById(t){const e=this.sourceFeatures.getFeatureById(t);return null!==e?[e]:[]}duplicateFeature(t){const e=this.featureById(t);if(1===e.length){const i=this.addProperties(e[0].clone());this.sourceFeatures.addFeature(i)}}removeFeature(t){const e=this.featureById(t);1===e.length&&this.sourceFeatures.removeFeature(e[0])}addProperties(t){++this._featuresCounter;const e=st();let i;return t.setId(e),i=void 0!==t.get("name")?t.get("name")+" copy":"feature "+this._featuresCounter,t.setProperties({id:t.getId(),no:this._featuresCounter,name:i,geom_type:t.getGeometry()?.getType(),status:"added",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),fill_color:this.fillColor,stroke_width:this.strokeWidth,stroke_color:this.strokeColor},!0),this._updateMetadataFeature(t),t}_updateMetadataFeature(t){t.setProperties({updated_at:(new Date).toISOString(),status:"modified"},!0)}addFeaturesAndUpdateIds(t){t.length>0&&t.forEach(e=>{let i=e.clone(),r=this.addProperties(i);this.sourceFeatures.addFeature(r)})}}class Vn{constructor(t,e){this.holePolygonDrawingStatus=!1,this._zoomPadding=[100,100,100,100],this._maxZoom=14,this.container=e,this._map=t,this._initSelect(),this._initTranslate(),this._initSnap(),this._initModifier(),this._map.addLayer(this.container.layer)}removeLayer(){this._map.removeLayer(this.container.layer)}enableTranslating(){this._map.addInteraction(this._translate)}disableTranslating(){this._map.removeInteraction(this._translate)}enableSelecting(){this._map.addInteraction(this.select)}disableSelecting(){this._map.removeInteraction(this.select)}enableSnapping(){this._map.addInteraction(this._snap)}disableSnapping(){this._map.removeInteraction(this._snap)}_initSelect(){this.select=new pn.Z({condition:k.V4,multi:!1,layers:[this.container.layer]})}_initSnap(){this._snap=new mn({source:this.container.layer.getSource()})}_initTranslate(){this._translate=new yn({features:this.select.getFeatures()})}_initModifier(){this._modifier=new vn({features:this.select.getFeatures(),deleteCondition:k.Ko,snapToPointer:!0}),this._modifier.on("modifyend",t=>{t.mapBrowserEvent.originalEvent.ctrlKey&&this._removeHoles(t),t.features.getArray().length>0&&t.features.getArray().forEach(e=>{this._updateMetadataFeature(e)})})}_removeHoles(t){const e=t.features.getArray()[0],i=t.mapBrowserEvent.coordinate;if("Polygon"==e.getGeometry().getType()){const r=e.getGeometry().getLinearRings();if(r.length>1){let s=new z.Z;r.forEach((c,d)=>{const u=new O.Z(c.getCoordinates());let p=new S.Z({geometry:u});p.setId(d),s.addFeature(p)});const a=s.getClosestFeatureToCoordinate(i);let l=[];r.forEach((c,d)=>{d!==a.getId()&&l.push(c.getCoordinates())}),e.getGeometry().setCoordinates(l)}}}enableEditing(){this.disableEditing(),this._map.addInteraction(this._modifier)}disableEditing(){this._map.removeInteraction(this._modifier)}cleanEvents(){this.disableDrawing(),this.disableEditing(),this.disableSelecting()}enableDrawing(t=!1){this.holePolygonDrawingStatus=t,this._draw=new Sn({type:this.container.geomType,stopClick:!0,source:this.container.sourceFeatures,condition:e=>1===e.originalEvent.buttons}),this._map.addInteraction(this._draw),t||this.disableSelecting(),this._draw.on("drawstart",this._onDrawStart.bind(this)),this._draw.on("drawend",this._onDrawEnd.bind(this)),this._draw.on("drawabort",this._onDrawAborting.bind(this))}disableDrawing(){this._map.removeInteraction(this._draw)}_updateMetadataFeature(t){t.setProperties({updated_at:(new Date).toISOString(),status:"modified"},!0)}_onDrawStart(t){if(this.holePolygonDrawingStatus&&"Polygon"===t.feature.getGeometry()?.getType()){let e=this.checkIfCoordIntersectLayer(t.feature);if(this.polygonIntersected=e,void 0===this.polygonIntersected)return t.target.abortDrawing(),this._onDrawAborting(t),void alert("An hole is possible only on a polygon!");if(void 0!==this.polygonIntersected){this.previousPolygonGeometry=this.polygonIntersected.getGeometry();const i=this.polygonIntersected.getGeometry();this.coordsLength=i.getCoordinates().length,t.feature.getGeometry().on("change",this._onGeomChangeBuildHole.bind(this))}}}_onDrawEnd(t){if(this.holePolygonDrawingStatus)return setTimeout(()=>{this.container.sourceFeatures.removeFeature(t.feature)},5),void 0!==this.polygonIntersected&&(t.feature.setGeometry(this.polygonIntersected.getGeometry()),this.select.getFeatures().clear()),void(this.polygonIntersected=void 0);this.container.addProperties(t.feature)}_onDrawAborting(t){this.holePolygonDrawingStatus&&void 0!==this.polygonIntersected&&(this.polygonIntersected.setGeometry(this.previousPolygonGeometry),this.polygonIntersected=void 0)}checkIfCoordIntersectLayer(t){let e;return this.container.sourceFeatures.forEachFeatureIntersectingExtent(t.getGeometry().getExtent(),i=>{e=i}),e}_onGeomChangeBuildHole(t){if(void 0!==this.polygonIntersected){let i=this.polygonIntersected.getGeometry().getCoordinates(),r=new G.ZP(i.slice(0,this.coordsLength)),s=new gn.Z(t.target.getCoordinates()[0]);r.appendLinearRing(s),this.polygonIntersected.setGeometry(r)}}zoomToLayer(){this.container.features.length>0&&this._map.getView().fit(this.container.layer.getSource().getExtent(),{size:this._map.getSize(),maxZoom:this._maxZoom,padding:this._zoomPadding})}zoomToFeature(t){this.container.features.filter(e=>{e.getId()===t&&this._map.getView().fit(e.getGeometry(),{size:this._map.getSize(),maxZoom:this._maxZoom})})}getFeatureAttribute(t,e){const i=this.container.featureById(t);if(1===i.length)return i[0].get(e)}exportBounds(){return this.container.sourceFeatures.getExtent().join(",").split(",").map(Number)}exportBoundsPolygon(){const t=this.exportBounds(),i=new G.ZP([[[t[0],t[3]],[t[2],t[3]],[t[2],t[1]],[t[0],t[1]],[t[0],t[3]]]]);return{Polygon:[new S.Z({geometry:i})]}}exportToGeoJSON(){let t=new nt;return JSON.stringify(JSON.parse(t.writeFeatures(this.container.features)),null,2)}exportToWkt(){let t=[];return this.container.features.forEach(e=>{t.push(Fe(e.getGeometry()))}),t.join("\n")}exportToPytestFixture(){let e=[];return this.container.features.forEach(i=>{e.push("\n@pytest.fixture\ndef "+i.get("name").replace(" ","_")+"():\n\treturn '"+Fe(i.getGeometry())+"'")}),"import pytest\n"+e.join("\n")}}function wt(o,t,e){const i=o.findIndex(a=>a.container.uuid===t),s=o[i].container.zIndex+e;return s>=0&&s<o.length&&(o[i].container.zIndex=s,(o=o.sort((a,l)=>a.container.zIndex<l.container.zIndex?-1:1)).forEach((a,l)=>{a.container.zIndex=l})),o}function Fe(o){return(new bt).writeGeometry(o)}function Pt(o){let t,e=o.getGeometry();if(void 0!==e){const i=o.get("fill_color"),r=o.get("stroke_width"),s=o.get("stroke_color");return"Point"===e.getType()?t=function Yn(o,t,e){return new J.ZP({image:new qn.Z({radius:7,fill:new we.Z({color:o}),stroke:new Pe.Z({color:e,width:t})})})}(i,r,s):"LineString"===e.getType()?t=function Kn(o,t,e){return[new J.ZP({fill:new we.Z({color:o}),stroke:new Pe.Z({color:e,width:2*t})}),new J.ZP({fill:new we.Z({color:o}),stroke:new Pe.Z({color:o,width:t})})]}(i,r,s):"Polygon"===e.getType()&&(t=function Wn(o,t,e){return new J.ZP({fill:new we.Z({color:o}),stroke:new Pe.Z({color:e,width:t})})}(i,r,s)),t}return new J.ZP}var R=m(3396);const $n=["POINT(539215.0048531858 5742515.939068312)","POINT(539296.087038823 5742385.422904979)","POINT(539356.2447894571 5742478.798196181)","POINT(539314.6574748883 5742559.095715506)"],ei=["LINESTRING(539218.6666293114 5742542.879278379,539338.720575142 5742544.971721878)","LINESTRING(539338.720575142 5742544.971721878,539360.6912318952 5742400.070009482)","LINESTRING(539360.6912318952 5742400.070009482,539237.7601762518 5742383.592016917)","LINESTRING(539218.6666293114 5742542.879278379,539237.7601762518 5742383.592016917)"],ti=["POLYGON((539226.5182729785 5742530.856872896,539232.6448189546 5742490.7562545985,539256.9808711325 5742494.193922905,539256.4417101032 5742499.585533198,539254.5546465009 5742504.7075629765,539250.5109387813 5742504.7075629765,539250.5109387813 5742509.020851211,539259.4070957643 5742507.942529152,539258.867934735 5742515.760364076,539260.3004442152 5742515.72208676,539260.1154706075 5742531.383185537,539226.5182729785 5742530.856872896))","POLYGON((539260.1154706075 5742531.383185537,539287.3729426434 5742531.99944534,539287.3112847741 5742498.704195973,539259.9351908506 5742495.12803956,539259.4070957643 5742507.942529152,539258.867934735 5742515.760364076,539260.3004442152 5742515.72208676,539260.1154706075 5742531.383185537),(539270.1545458606 5742508.569826204,539269.7288732142 5742508.536220469,539269.7387920542 5742506.9663504455,539267.7040823707 5742506.9663504455,539267.8273981091 5742504.3767199395,539275.904578974 5742504.191746332,539279.9739983409 5742504.191746332,539279.9123404718 5742506.843034708,539272.0955777467 5742506.707124501,539271.7118438686 5742508.692770784,539270.1545458606 5742508.569826204))","POLYGON((539287.3729426434 5742531.99944534,539318.0346724865 5742532.378169541,539319.9065139169 5742531.559238915,539321.4273850791 5742530.038367753,539324.9370877611 5742504.300548085,539294.9876248749 5742499.737934599,539287.3112847741 5742498.704195973,539287.3729426434 5742531.99944534),(539295.3754938005 5742507.421860116,539295.4466824754 5742503.221728295,539298.9348396178 5742503.597902105,539299.2196822468 5742506.211652642,539301.1417764699 5742507.63542614,539300.9282104451 5742509.984652413,539301.070587795 5742511.408425912,539298.934927547 5742511.266048562,539298.6501728473 5742508.916822289,539297.1300637128 5742508.069037543,539295.3754938005 5742507.421860116))","POLYGON((539294.9876248749 5742499.737934599,539299.5562570365 5742468.337040057,539329.0781557556 5742472.196111785,539324.9370877611 5742504.300548085,539294.9876248749 5742499.737934599))","POLYGON((539259.9351908506 5742495.12803956,539256.9808711325 5742494.193922905,539232.6448189546 5742490.7562545985,539235.2430055273 5742471.432241965,539263.2547045123 5742475.410715154,539261.062456945 5742495.2752950415,539259.9351908506 5742495.12803956))","POLYGON((539235.2430055273 5742471.432241965,539237.7456480276 5742451.885722645,539265.9128935036 5742455.147193177,539263.2547045123 5742475.410715154,539235.2430055273 5742471.432241965))","POLYGON((539237.7456480276 5742451.885722645,539240.2658752541 5742432.168650814,539268.1366234096 5742436.319613306,539265.9128935036 5742455.147193177,539237.7456480276 5742451.885722645))","POLYGON((539299.5562570365 5742468.337040057,539302.9750586041 5742442.1013110615,539268.1366234096 5742436.319613306,539265.9128935036 5742455.147193177,539263.2547045123 5742475.410715154,539261.062456945 5742495.2752950415,539287.3112847741 5742498.704195973,539294.9876248749 5742499.737934599,539299.5562570365 5742468.337040057))","POLYGON((539300.4403774067 5742461.5523402225,539306.3847777933 5742462.263128876,539305.2312471652 5742469.078868832,539299.5562570365 5742468.337040057,539300.4403774067 5742461.5523402225))","POLYGON((539329.0781557556 5742472.196111785,539333.6625313073 5742445.2145329295,539310.683988945 5742442.546057043,539306.1134484276 5742469.194189259,539329.0781557556 5742472.196111785))","POLYGON((539333.6625313073 5742445.2145329295,539337.225770125 5742416.486706159,539337.0295486205 5742412.562276067,539335.263555079 5742409.226510488,539333.1051185282 5742406.675630929,539330.3580174637 5742405.890744911,539253.242966151 5742396.0796696795,539248.3374285357 5742397.649441716,539245.5903274711 5742400.788985791,539243.8243339296 5742405.694523405,539240.2658752541 5742432.168650814,539268.1366234096 5742436.319613306,539302.9750586041 5742442.1013110615,539310.683988945 5742442.546057043,539333.6625313073 5742445.2145329295),(539258.4659895932 5742428.264073253,539259.96085796 5742413.215731693,539320.2538820857 5742421.188362983,539318.5596979368 5742438.72815182,539272.3084690453 5742432.624896874,539272.2187785674 5742430.257231075,539258.4659895932 5742428.264073253))","POLYGON((539302.325413111 5742447.086661268,539305.5990284064 5742447.378161909,539306.2690154614 5742442.291347034,539302.9750586041 5742442.1013110615,539302.325413111 5742447.086661268))"];var I=m(4945),j=m(4006);function ni(o,t){if(1&o){const e=n.EpF();n.ynx(0),n.TgZ(1,"button",16),n.NdJ("click",function(){const s=n.CHM(e).$implicit,a=n.oxw();return n.KtG(a.setImportDataType(s.label_text))}),n._UZ(2,"fa-icon",17),n._uU(3),n.qZA(),n.BQk()}if(2&o){const e=t.$implicit;n.xp6(1),n.Q6J("ngbPopover",e.label),n.xp6(1),n.Q6J("icon",e.icon),n.xp6(1),n.hij("",e.label_text," ")}}function ii(o,t){if(1&o&&(n.TgZ(0,"option",18),n._uU(1),n.qZA()),2&o){const e=t.$implicit;n.Q6J("value",e),n.xp6(1),n.Oqu(e)}}function ri(o,t){if(1&o&&(n.TgZ(0,"option",18),n._uU(1),n.qZA()),2&o){const e=t.$implicit;n.Q6J("value",e.container.uuid),n.xp6(1),n.hij("Importer dans la couche : ",e.container.layerName,"")}}let si=(()=>{class o{constructor(){this.featuresToNewLayerEvent=new n.vpe,this.featuresToAppendEvent=new n.vpe,this.loadIcon=_.cf$,this.importModes=[{mode:"GeoJSON",label:"Importer un GeoJSON",label_text:"GeoJSON",icon:this.loadIcon},{mode:"WKT",label:"Importer un/des WKT(s)",label_text:"WKT(s)",icon:this.loadIcon}],this.componentRemoved=!1,this.strInputDataValues=null,this.strInputEpsgInput=null,this.modeImportInput="newLayer"}ngOnInit(){}ngOnDestroy(){this.componentRemoved=!0}setImportDataType(e){this.importDataType=e}importFromFormat(){let i,e={};this.strInputEpsgInput!==this.currentEpsg&&(e={dataProjection:this.strInputEpsgInput,featureProjection:this.currentEpsg}),null!==this.strInputDataValues&&("GeoJSON"===this.importDataType?i=function oi(o,t){let e={};return e=function ai(o){return o.reduce((t,e)=>{let i=e.getGeometry().getType();return t[i]||(t[i]=[]),t[i].push(e),t},{})}(new z.Z({features:(new nt).readFeatures(JSON.parse(o,t))}).getFeatures()),e}(this.strInputDataValues,e):"WKT(s)"===this.importDataType&&(i=Ve(this.strInputDataValues.split("\n"),e)),"newLayer"===this.modeImportInput?this.featuresToNewLayerEvent.emit(i):this.featuresToAppendEvent.emit({layerId:this.modeImportInput,features:i})),this.strInputDataValues=null,this.strInputEpsgInput=null,this.modeImportInput="newLayer"}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-import-tools"]],inputs:{epsgAvailable:"epsgAvailable",currentEpsg:"currentEpsg",existingLayers:"existingLayers"},outputs:{featuresToNewLayerEvent:"featuresToNewLayerEvent",featuresToAppendEvent:"featuresToAppendEvent"},decls:25,vars:9,consts:[[1,"text-center","fw-bold","bg-dark","bg-gradient","text-white","p-2"],["id","importTools",1,"text-center","m-3"],[4,"ngFor","ngForOf"],["moveDivToBody","","id","modalDataImport","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade",3,"isRemoved"],[1,"modal-dialog","modal-lg","modal-dialog-scrollable"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],[1,"form-control",3,"ngModel","ngModelChange"],[1,"form-select","form-select-sm",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["value","newLayer"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"ngClass","click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["data-bs-toggle","modal","data-bs-target","#modalDataImport","type","button","role","tab","placement","bottom","triggers","mouseenter:mouseleave",1,"btn","btn-sm","btn-dark","border-0","m-1","text-warning",3,"ngbPopover","click"],[1,"mx-1",3,"icon"],[3,"value"]],template:function(e,i){1&e&&(n.TgZ(0,"div",0),n._uU(1," Importer "),n.qZA(),n.TgZ(2,"div",1),n.YNc(3,ni,4,3,"ng-container",2),n.qZA(),n.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"h5",7),n._uU(9),n.qZA()(),n.TgZ(10,"div",8)(11,"textarea",9),n.NdJ("ngModelChange",function(s){return i.strInputDataValues=s}),n.qZA(),n._uU(12," EPSG des donn\xe9es \xe0 importer "),n.TgZ(13,"select",10),n.NdJ("ngModelChange",function(s){return i.strInputEpsgInput=s}),n.YNc(14,ii,2,2,"option",11),n.qZA(),n._uU(15," Type d'importation "),n.TgZ(16,"select",10),n.NdJ("ngModelChange",function(s){return i.modeImportInput=s}),n.TgZ(17,"option",12),n._uU(18,"Cr\xe9er de nouvelles couches"),n.qZA(),n.YNc(19,ri,2,2,"option",11),n.qZA()(),n.TgZ(20,"div",13)(21,"button",14),n.NdJ("click",function(){return i.importFromFormat()}),n._uU(22,"Ajouter"),n.qZA(),n.TgZ(23,"button",15),n._uU(24,"Fermer"),n.qZA()()()()()),2&e&&(n.xp6(3),n.Q6J("ngForOf",i.importModes),n.xp6(1),n.Q6J("isRemoved",i.componentRemoved),n.xp6(5),n.hij("Importer ",i.importDataType,""),n.xp6(2),n.Q6J("ngModel",i.strInputDataValues),n.xp6(2),n.Q6J("ngModel",i.strInputEpsgInput),n.xp6(1),n.Q6J("ngForOf",i.epsgAvailable),n.xp6(2),n.Q6J("ngModel",i.modeImportInput),n.xp6(3),n.Q6J("ngForOf",i.existingLayers),n.xp6(2),n.Q6J("ngClass",null!==i.strInputEpsgInput&&null!==i.strInputDataValues?"":"pe-none"))},dependencies:[w.mk,w.sg,A.BN,I.o8,j.YN,j.Kr,j.Fj,j.EJ,j.JJ,j.On,Me]}),o})();function Ve(o,t){let e={};return o.forEach(i=>{let r;try{r=(new bt).readFeature(i,t)}catch(s){alert(s.message)}if(void 0!==r&&!r.getGeometry().flatCoordinates.includes(NaN)){const s=r.getGeometry(),a=s.getType();a in e||(e[a]=[]),void 0!==s&&e[a].push(r)}}),e}let Le=(()=>{class o{constructor(){this.newFeatures=new Y.x,this.snappingLayerEnabled=new Y.x}addNewFeatures(e){this.newFeatures.next(e)}activateSnapping(e){this.snappingLayerEnabled.next(e)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=n.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function li(o,t){if(1&o&&(n.O4$(),n.TgZ(0,"svg",13),n._UZ(1,"circle",14),n.qZA()),2&o){const e=n.oxw();n.xp6(1),n.uIk("stroke",e.feature.get("stroke_color"))("stroke-width",e.feature.get("stroke_width"))("fill",e.feature.get("fill_color"))}}function ci(o,t){if(1&o&&(n.O4$(),n.TgZ(0,"svg",13),n._UZ(1,"line",15)(2,"line",15),n.qZA()),2&o){const e=n.oxw();n.xp6(1),n.uIk("stroke",e.feature.get("stroke_color"))("stroke-width",2*e.feature.get("stroke_width")),n.xp6(1),n.uIk("stroke",e.feature.get("fill_color"))("stroke-width",1.5*e.feature.get("stroke_width"))}}function di(o,t){if(1&o&&(n.O4$(),n.TgZ(0,"svg",16),n._UZ(1,"rect",17),n.qZA()),2&o){const e=n.oxw();n.xp6(1),n.uIk("stroke",e.feature.get("stroke_color"))("stroke-width",e.feature.get("stroke_width"))("fill",e.feature.get("fill_color"))}}function ui(o,t){if(1&o){const e=n.EpF();n.TgZ(0,"div",18)(1,"div",19)(2,"div",20)(3,"strong"),n._uU(4),n.qZA(),n.TgZ(5,"em",21),n._uU(6),n.qZA(),n.TgZ(7,"em",6),n._uU(8),n.qZA(),n.TgZ(9,"button",22),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.showPopup())}),n.qZA()(),n.TgZ(10,"div",23)(11,"div",24)(12,"span",25),n._uU(13,"Actions :"),n.qZA(),n.TgZ(14,"span",26),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.copyToClipboard(r.getWktFromFeature()))}),n._uU(15," WKT "),n.qZA(),n.TgZ(16,"span",27),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.copyToClipboard(r.getBoundsFromFeature()))}),n._uU(17," Bbox "),n.qZA()(),n.TgZ(18,"div",28)(19,"span"),n._uU(20),n.ALo(21,"date"),n.qZA(),n.TgZ(22,"span"),n._uU(23),n.ALo(24,"date"),n.qZA()(),n.TgZ(25,"div",29)(26,"h6",5),n._uU(27,"Style"),n.qZA(),n.TgZ(28,"div",30)(29,"span",31),n._uU(30,"Couleur de fond :"),n.qZA(),n.TgZ(31,"input",32,33),n.NdJ("change",function(){n.CHM(e);const r=n.MAs(32),s=n.oxw();return n.KtG(s.updateFillColor(r.value))}),n.qZA(),n._UZ(33,"label",34),n.qZA(),n.TgZ(34,"div",30)(35,"span",31),n._uU(36,"Couleur du contour :"),n.qZA(),n.TgZ(37,"input",35,36),n.NdJ("change",function(){n.CHM(e);const r=n.MAs(38),s=n.oxw();return n.KtG(s.updateStrokeColor(r.value))}),n.qZA(),n._UZ(39,"label",37),n.qZA(),n.TgZ(40,"div",30)(41,"span",31),n._uU(42,"Epaisseur du contour :"),n.qZA(),n.TgZ(43,"input",38),n.NdJ("change",function(r){n.CHM(e);const s=n.oxw();return n.KtG(s.updateStrokeWidth(r))}),n.qZA()()()()()()}if(2&o){const e=n.oxw();n.Q6J("id","featurePopup"+e.feature.getId()),n.xp6(4),n.Oqu(e.feature.get("name")),n.xp6(2),n.hij("(",e.feature.get("geom_type"),")"),n.xp6(2),n.hij("Couche: ",e.layer.container.layerName,""),n.xp6(12),n.hij("Cr\xe9\xe9 \xe0 ",n.xi3(21,9,e.feature.get("created_at"),"HH:mm:ss"),""),n.xp6(3),n.hij("Modifi\xe9 \xe0 ",n.xi3(24,12,e.feature.get("updated_at"),"HH:mm:ss"),""),n.xp6(8),n.Q6J("value",e.feature.get("fill_color")),n.xp6(6),n.Q6J("value",e.feature.get("stroke_color")),n.xp6(6),n.Q6J("value",e.currentStrokeWidth)}}let hi=(()=>{class o{constructor(e){this.elementRef=e,this.disabledIcon=_.g82,this.duplicateIcon=R.WM4,this.centerIcon=_.TL5,this.paramIcon=_.gr5,this.displayPopup=!1}ngOnInit(){this.currentFillColor=this.feature.get("fill_color"),this.currentStrokeColor=this.feature.get("stroke_color"),this.currentStrokeWidth=this.feature.get("stroke_width")}ngOnDestroy(){this.elementRef.nativeElement.remove()}set feature(e){this._feature=e,this._id=e.getId(),this._geometry=e.getGeometry()}get feature(){return this._feature}get id(){return this._id}get geometry(){return this._geometry}set selected(e){this.displayPopup=!1,this._selected=e}get selected(){return this._selected}removeFeature(){this.layer.container.removeFeature(this.id)}duplicateFeature(){this.layer.select.getFeatures().clear(),this.layer.container.duplicateFeature(this.id)}zoomToFeature(){this.layer.zoomToFeature(this.id)}showPopup(){this.displayPopup=!this.displayPopup}copyToClipboard(e){const i=document.createElement("textarea");i.style.position="fixed",i.style.left="0",i.style.top="0",i.style.opacity="0",i.value=e,document.body.appendChild(i),i.focus(),i.select(),document.execCommand("copy"),document.body.removeChild(i)}updateFillColor(e){this.feature.set("fill_color",e,!0)}updateStrokeWidth(e){this.feature.set("stroke_width",e.target.value,!0)}updateStrokeColor(e){this.feature.set("stroke_color",e,!0)}getWktFromFeature(){return Fe(this.geometry)}getBoundsFromFeature(){return this.geometry.getExtent().join(", ")}}return o.\u0275fac=function(e){return new(e||o)(n.Y36(n.SBq))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-feature"]],inputs:{layer:"layer",feature:"feature",selected:"selected"},decls:18,vars:9,consts:[[1,"feature-content","py-0","d-flex","align-items-center","pointer","border-bottom"],[1,"d-flex","flex-row","pointer","justify-content-start","align-items-center","flex-fill"],[1,"m-1"],["height","25","width","25",4,"ngIf"],["height","15","width","25",4,"ngIf"],[1,""],[1,"ms-auto"],["ngbPopover","Center sur l'object","triggers","mouseenter:mouseleave",1,"ms-auto","btn","p-1","bg-transparent","border-0",3,"click"],["size","xs",1,"",3,"icon"],["ngbPopover","Dupliquer l'object","triggers","mouseenter:mouseleave",1,"ms-auto","btn","p-1","bg-transparent","border-0",3,"click"],["ngbPopover","Supprimer l'object","triggers","mouseenter:mouseleave",1,"btn","m-0","bg-transparent","border-0","text-danger",3,"click"],["ngbPopover","Options de l'objet","triggers","mouseenter:mouseleave",1,"btn","m-0","bg-transparent","border-0","text-black",3,"click"],["class","featureToast position-fixed bottom-0 end-0 p-3 d-flex flex-row overflow-auto fw-normal pointer-none","style","z-index: 11",3,"id",4,"ngIf"],["height","25","width","25"],["cx","12","cy","12","r","8"],["x1","0","y1","12.5","x2","25","y2","12.5"],["height","15","width","25"],["x","0","y","0","width","25","height","15"],[1,"featureToast","position-fixed","bottom-0","end-0","p-3","d-flex","flex-row","overflow-auto","fw-normal","pointer-none",2,"z-index","11",3,"id"],["role","alert","aria-live","assertive","aria-atomic","true",1,"toast","toastFeature","faded"],[1,"toast-header","justify-content-between"],[1,"ms-2","me-auto","me-auto"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"toast-body","bg-white"],["id","toastActions",1,"d-flex","flex-row","justify-content-start","align-items-center"],[1,"fw-bold"],["data-bs-toggle","tooltip","data-bs-placement","bottom","title","Copier le WKT",1,"badge","bg-dark","rounded","m-1","small","pointer",3,"click"],["data-bs-toggle","tooltip","data-bs-placement","bottom","title","Copier la Bbox (xmin, ymin, xmax, ymax)",1,"badge","bg-primary","rounded","m-1","small","pointer",3,"click"],[1,"d-flex","flex-row","justify-content-between"],[1,"d-flex","flex-column","my-3"],[1,"d-flex","flex-row","ms-2","my-1"],[1,"me-2"],["type","color","id","fillColor",1,"fillColor","m-1","pointer",3,"value","change"],["fillColor",""],["for","fillColor"],["type","color","id","strokeColor",1,"strokeColor","m-1","pointer",3,"value","change"],["strokeColor",""],["for","strokeColor"],["type","number","min","0","max","12",1,"small","strokeWidth",3,"value","change"]],template:function(e,i){1&e&&(n.TgZ(0,"li",0)(1,"div",1)(2,"div",2),n.YNc(3,li,2,3,"svg",3),n.YNc(4,ci,3,4,"svg",3),n.YNc(5,di,2,3,"svg",4),n.qZA(),n.TgZ(6,"div",5),n._uU(7),n.qZA(),n.TgZ(8,"div",6)(9,"button",7),n.NdJ("click",function(){return i.zoomToFeature()}),n._UZ(10,"fa-icon",8),n.qZA(),n.TgZ(11,"button",9),n.NdJ("click",function(){return i.duplicateFeature()}),n._UZ(12,"fa-icon",8),n.qZA(),n.TgZ(13,"button",10),n.NdJ("click",function(){return i.removeFeature()}),n._UZ(14,"fa-icon",8),n.qZA(),n.TgZ(15,"button",11),n.NdJ("click",function(){return i.showPopup()}),n._UZ(16,"fa-icon",8),n.qZA()()()(),n.YNc(17,ui,44,15,"div",12)),2&e&&(n.xp6(3),n.Q6J("ngIf","Point"===i.feature.get("geom_type")),n.xp6(1),n.Q6J("ngIf","LineString"===i.feature.get("geom_type")),n.xp6(1),n.Q6J("ngIf","Polygon"===i.feature.get("geom_type")),n.xp6(2),n.hij(" ",i.feature.get("name")," "),n.xp6(3),n.Q6J("icon",i.centerIcon),n.xp6(2),n.Q6J("icon",i.duplicateIcon),n.xp6(2),n.Q6J("icon",i.disabledIcon),n.xp6(2),n.Q6J("icon",i.paramIcon),n.xp6(1),n.Q6J("ngIf",i.displayPopup))},dependencies:[w.O5,A.BN,I.o8,w.uU],styles:[".pointer[_ngcontent-%COMP%]{cursor:pointer}.pointer-none[_ngcontent-%COMP%]{cursor:auto}.feature[_ngcontent-%COMP%]:hover{font-weight:700}.toast[_ngcontent-%COMP%]{opacity:0;display:unset!important;transition:opacity .5s}.faded[_ngcontent-%COMP%]{opacity:1!important;transition:opacity .5s!important}.feature-content[_ngcontent-%COMP%]{animation-name:_ngcontent-%COMP%_featureColorTransition;animation-duration:.5s}@keyframes _ngcontent-%COMP%_featureColorTransition{0%{background-color:var(--bs-secondary)}to{background-color:var(--bs-light)}}"]}),o})();function gi(o,t){if(1&o){const e=n.EpF();n.ynx(0),n.TgZ(1,"input",8,22),n.NdJ("click",function(){n.CHM(e);const r=n.MAs(2),s=n.oxw(2);return n.KtG(s.translateHandler(r.checked))}),n.qZA(),n.TgZ(3,"label",23)(4,"div",11),n._UZ(5,"fa-icon",12),n.qZA()(),n.BQk()}if(2&o){const e=n.oxw(2);n.xp6(1),n.Q6J("id","btnMove"+e.layer.container.uuid)("checked",e.isMoved),n.xp6(2),n.Q6J("for","btnMove"+e.layer.container.uuid),n.xp6(1),n.Q6J("ngClass",e.isMoved?"btn-outline-danger":""),n.xp6(1),n.Q6J("icon",e.moveIcon)}}function pi(o,t){if(1&o){const e=n.EpF();n.ynx(0),n.TgZ(1,"input",8,24),n.NdJ("click",function(){n.CHM(e);const r=n.MAs(2),s=n.oxw(2);return n.KtG(s.drawHoleHandler(r.checked,!0))}),n.qZA(),n.TgZ(3,"label",25)(4,"div",11),n._UZ(5,"fa-icon",12),n.qZA()(),n.BQk()}if(2&o){const e=n.oxw(2);n.xp6(1),n.Q6J("id","btnHole"+e.layer.container.uuid)("checked",e.isHole),n.xp6(2),n.Q6J("for","btnHole"+e.layer.container.uuid),n.xp6(1),n.Q6J("ngClass",e.isHole?"btn-outline-danger":""),n.xp6(1),n.Q6J("icon",e.polygonIcon)}}const fi=function(){return["Polygon","LineString"]},mi=function(){return["Polygon"]};function _i(o,t){if(1&o){const e=n.EpF();n.TgZ(0,"div",5)(1,"div",6)(2,"span",7),n._uU(3,"Ajouter"),n.qZA(),n.TgZ(4,"input",8,9),n.NdJ("click",function(){n.CHM(e);const r=n.MAs(5),s=n.oxw();return n.KtG(s.drawHandler(r.checked))}),n.qZA(),n.TgZ(6,"label",10)(7,"div",11),n._UZ(8,"fa-icon",12),n.qZA()()(),n.TgZ(9,"div",6)(10,"span",7),n._uU(11,"Editer"),n.qZA(),n.YNc(12,gi,6,5,"ng-container",13),n.TgZ(13,"input",8,14),n.NdJ("click",function(){n.CHM(e);const r=n.MAs(14),s=n.oxw();return n.KtG(s.editHandler(r.checked))}),n.qZA(),n.TgZ(15,"label",15)(16,"div",11),n._UZ(17,"fa-icon",12),n.qZA()(),n.YNc(18,pi,6,5,"ng-container",13),n.qZA(),n.TgZ(19,"div",6)(20,"span",7),n._uU(21,"Calculer"),n.qZA(),n.ynx(22),n.TgZ(23,"button",16),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.computeBoundingBox())}),n._UZ(24,"fa-icon",12),n.qZA(),n.BQk(),n.TgZ(25,"div",6)(26,"span",7),n._uU(27,"Misc"),n.qZA(),n.TgZ(28,"input",17,18),n.NdJ("click",function(){n.CHM(e);const r=n.MAs(29),s=n.oxw();return n.KtG(s.snappingHandler(r.checked))}),n.qZA(),n.TgZ(30,"label",19)(31,"div",20),n._UZ(32,"fa-icon",21),n.qZA()()()()()}if(2&o){const e=n.oxw();n.xp6(4),n.Q6J("id","btnDraw"+e.layer.container.uuid)("checked",e.isDrawn),n.xp6(2),n.Q6J("for","btnDraw"+e.layer.container.uuid)("ngbPopover","Ajouter un objet de type '"+e.layer.container.geomType+"'"),n.xp6(1),n.Q6J("ngClass",e.isDrawn?"btn-outline-danger":""),n.xp6(1),n.Q6J("icon",e.addIcon),n.xp6(4),n.Q6J("ngIf",n.DdM(20,fi).includes(e.layer.container.geomType)),n.xp6(1),n.Q6J("id","btnEdit"+e.layer.container.uuid)("checked",e.isEdited),n.xp6(2),n.Q6J("for","btnEdit"+e.layer.container.uuid),n.xp6(1),n.Q6J("ngClass",e.isEdited?"btn-outline-danger":""),n.xp6(1),n.Q6J("icon",e.editIcon),n.xp6(1),n.Q6J("ngIf",n.DdM(21,mi).includes(e.layer.container.geomType)),n.xp6(6),n.Q6J("icon",e.centerIcon),n.xp6(4),n.Q6J("disabled",e.editing)("checked",e.isSnapped),n.xp6(3),n.ekj("disabled",e.editing),n.Q6J("ngClass",e.isSnapped?"btn-danger":"btn-outline-dark"),n.xp6(1),n.Q6J("icon",e.snapIcon)}}let yi=(()=>{class o{constructor(e){this.editComputingService=e,this.addIcon=_.EQ8,this.editIcon=_.TzT,this.paramIcon=_.gr5,this.lockIcon=_.byT,this.unLockIcon=_._1N,this.polygonIcon=_.ubJ,this.moveIcon=_.$pG,this.pathIcon=_.KJ_,this.motorIcon=_.yn$,this.pedestrianIcon=_.EiI,this.centerIcon=_.TL5,this.snapIcon=_.mlU,this.isDrawn=!1,this.isEdited=!1,this.isHole=!1,this.isMoved=!1,this.isShortestPath=!1,this.editing=!1,this.isSnapped=!1,this.epsgAvailable=["EPSG:4326","EPSG:3857"],this.strInputDataValues=null,this.strInputEspgInput=null}ngOnInit(){}ngOnDestroy(){this.disableEditing()}set layer(e){this._layer=e}get layer(){return this._layer}set enabled(e){e||this.disableEditing(),this._enabled=e}get enabled(){return this._enabled}enableSnapModeOnAllOthersLayers(){this.isSnapped&&this.editComputingService.activateSnapping(!0)}disableSnapModeOnAllOthersLayers(){this.isSnapped&&this.editComputingService.activateSnapping(!1)}snappingHandler(e){this.isSnapped=e,e||this.disableSnapModeOnAllOthersLayers()}disableEditing(e=!0){this.drawHoleHandler(!1),this.drawHandler(!1),this.editHandler(!1),this.translateHandler(!1),this.disableSnapModeOnAllOthersLayers(),e&&this.unSelectFeature()}unSelectFeature(){this.layer.select.getFeatures().clear()}translateHandler(e){e?(this.disableEditing(!1),this.translateFeatureEnable()):this.translateFeatureDisable()}editHandler(e){e?(this.disableEditing(!1),this.editFeatureEnable(),this.enableSnapModeOnAllOthersLayers()):(this.editFeatureDisable(),this.disableSnapModeOnAllOthersLayers())}drawHandler(e,i=!1){e?(this.disableEditing(!1),this.addFeatureEnable(i),this.enableSnapModeOnAllOthersLayers()):(this.addFeatureDisable(),this.disableSnapModeOnAllOthersLayers())}drawHoleHandler(e,i=!0){e?(this.disableEditing(!1),this.addHoleFeatureEnable(i),this.enableSnapModeOnAllOthersLayers()):(this.addHoleFeatureDisable(),this.disableSnapModeOnAllOthersLayers())}translateFeatureEnable(){this.layer.enableTranslating(),this.isMoved=!0,this.editing=!0}translateFeatureDisable(){this.layer.disableTranslating(),this.isMoved=!1,this.editing=!1}addFeatureEnable(e=!1){this.layer.enableDrawing(e),this.isDrawn=!0,this.editing=!0}addFeatureDisable(){this.layer.disableDrawing(),this.isDrawn=!1,this.editing=!1}editFeatureEnable(){this.layer.enableEditing(),this.isEdited=!0,this.editing=!0}editFeatureDisable(){this.layer.disableEditing(),this.isEdited=!1,this.editing=!1}addHoleFeatureEnable(e=!0){this.layer.enableDrawing(e),this.isHole=!0,this.editing=!0}addHoleFeatureDisable(){this.layer.disableDrawing(),this.isHole=!1,this.editing=!1}computeBoundingBox(){this.layer.container.features.length>0&&this.editComputingService.addNewFeatures(this.layer.exportBoundsPolygon())}}return o.\u0275fac=function(e){return new(e||o)(n.Y36(Le))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-edit-bar"]],inputs:{currentEpsg:"currentEpsg",layer:"layer",enabled:"enabled"},decls:7,vars:3,consts:[[1,"d-flex","flex-column","editTools","bg-dark","bg-gradient","p-2","m-2","rounded-3","shadow"],[1,"d-flex","flex-row","align-items-center","justify-content-center","text-warning","m-1"],[1,"fw-bold","me-1"],[1,"fst-italic"],["class","d-flex flex-row m-1",4,"ngIf"],[1,"d-flex","flex-row","m-1"],[1,"d-flex","flex-row","m-1","align-items-center","shadow","border","rounded","bg-light"],[1,"text-dark","m-2","fw-bold","small"],["type","checkbox",1,"btn-check",3,"id","checked","click"],["btnDraw",""],["triggers","mouseenter:mouseleave",3,"for","ngbPopover"],[1,"btn","btn-outline-success","m-1",3,"ngClass"],[3,"icon"],[4,"ngIf"],["btnEdit",""],["ngbPopover","Editer","triggers","mouseenter:mouseleave",3,"for"],["ngbPopover","La bounding box","triggers","mouseenter:mouseleave",1,"btn","btn-outline-success","m-1",3,"click"],["type","checkbox","id","btnSnap",1,"btn-check",3,"disabled","checked","click"],["btnSnap",""],["for","btnSnap","container","body","ngbPopover","Activer le snapping","triggers","mouseenter:mouseleave"],[1,"btn","m-1",3,"ngClass"],["size","xs",3,"icon"],["btnMove",""],["ngbPopover","D\xe9placer","triggers","mouseenter:mouseleave",3,"for"],["btnHole",""],["ngbPopover","Ajouter un trou","triggers","mouseenter:mouseleave",3,"for"]],template:function(e,i){1&e&&(n.TgZ(0,"div",0)(1,"div",1)(2,"span",2),n._uU(3),n.qZA(),n.TgZ(4,"span",3),n._uU(5),n.qZA()(),n.YNc(6,_i,33,22,"div",4),n.qZA()),2&e&&(n.xp6(3),n.Oqu(i.layer.container.layerName),n.xp6(2),n.hij("(",i.layer.container.geomType,")"),n.xp6(1),n.Q6J("ngIf",i.enabled))},dependencies:[w.mk,w.O5,A.BN,I.o8]}),o})();function Ci(o,t){if(1&o&&n._UZ(0,"fa-icon",43),2&o){const e=n.oxw();n.Q6J("icon",e.pointIcon)}}function xi(o,t){if(1&o&&n._UZ(0,"fa-icon",43),2&o){const e=n.oxw();n.Q6J("icon",e.lineStringIcon)}}function Ti(o,t){if(1&o&&n._UZ(0,"fa-icon",43),2&o){const e=n.oxw();n.Q6J("icon",e.polygonIcon)}}function vi(o,t){if(1&o){const e=n.EpF();n.ynx(0),n.TgZ(1,"app-feature",50),n.NdJ("click",function(){const s=n.CHM(e).$implicit,a=n.oxw(2);return n.KtG(a.selectFeatureById(s.get("id")))}),n.qZA(),n.BQk()}if(2&o){const e=t.$implicit,i=n.oxw(2);n.xp6(1),n.Q6J("ngClass",i.featuresIdSelected.includes(e.get("id"))?"fw-bold bg-secondary bg-opacity-25":"")("selected",i.featuresIdSelected.includes(e.get("id")))("feature",e)("layer",i.layer)}}function bi(o,t){if(1&o){const e=n.EpF();n.TgZ(0,"div",44)(1,"ul",45)(2,"li",46),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.unSelectFeatures())}),n.TgZ(3,"div",47),n._UZ(4,"fa-icon",48),n._uU(5,"D\xe9s\xe9lectionner "),n.qZA()(),n.YNc(6,vi,2,4,"ng-container",49),n.qZA()()}if(2&o){const e=n.oxw();n.xp6(1),n.Q6J("hidden",e.toggled)("id","featuresLayer-"+e.layer.container.uuid),n.xp6(1),n.Q6J("ngClass",e.featuresIdSelected.length>0&&e.selected?"bg-opacity-25":""),n.xp6(2),n.Q6J("icon",e.disabledIcon),n.xp6(2),n.Q6J("ngForOf",e.layer.container.features)}}function wi(o,t){if(1&o&&n._UZ(0,"app-edit-bar",53),2&o){const e=n.oxw(2);n.Q6J("layer",e.layer)("enabled",!e.locked&&e.selected)("currentEpsg",e.epsg)}}function Pi(o,t){if(1&o&&(n.TgZ(0,"div",51),n.YNc(1,wi,1,3,"app-edit-bar",52),n.qZA()),2&o){const e=n.oxw();n.Q6J("isRemoved",e.isLayerRemoved),n.xp6(1),n.Q6J("ngIf",e.selected)}}function Fi(o,t){1&o&&n.GkF(0)}const Ye=function(o){return{layerObject:o}};function Li(o,t){if(1&o&&(n.TgZ(0,"div",54),n.YNc(1,Fi,1,0,"ng-container",55),n.qZA()),2&o){const e=n.oxw(),i=n.MAs(65);n.xp6(1),n.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",n.VKq(2,Ye,e.layer))}}function Ei(o,t){1&o&&n.GkF(0)}function Ii(o,t){if(1&o&&(n.TgZ(0,"div",54),n.YNc(1,Ei,1,0,"ng-container",55),n.qZA()),2&o){const e=n.oxw(),i=n.MAs(67);n.xp6(1),n.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",n.VKq(2,Ye,e.layer))}}function Si(o,t){1&o&&n.GkF(0)}function Mi(o,t){if(1&o&&(n.TgZ(0,"div",54),n.YNc(1,Si,1,0,"ng-container",55),n.qZA()),2&o){const e=n.oxw(),i=n.MAs(69);n.xp6(1),n.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",n.VKq(2,Ye,e.layer))}}function ki(o,t){if(1&o){const e=n.EpF();n.TgZ(0,"span",56),n._uU(1,"Informations g\xe9n\xe9rales"),n.qZA(),n.TgZ(2,"div",57)(3,"span",58),n._uU(4,"Nom de la couche :"),n.qZA(),n.TgZ(5,"input",59,60),n.NdJ("change",function(){n.CHM(e);const r=n.MAs(6),s=n.oxw();return n.KtG(s.layer.container.layerName=r.value)}),n.qZA()(),n.TgZ(7,"div",57)(8,"span",58),n._uU(9,"Type de la g\xe9om\xe9trie :"),n.qZA(),n.TgZ(10,"span"),n._uU(11),n.qZA()(),n.TgZ(12,"div",61)(13,"span",62),n._uU(14,"Bounding box de la couche:"),n.qZA(),n.TgZ(15,"span",63),n._uU(16),n.qZA(),n.TgZ(17,"span",63),n._uU(18),n.qZA()()}if(2&o){const e=n.oxw();n.xp6(5),n.Q6J("placeholder",e.layer.container.layerName),n.xp6(6),n.Oqu(e.layer.container.geomType),n.xp6(5),n.AsE("x min, x max: ",e.layer.exportBounds()[0],", ",e.layer.exportBounds()[2],""),n.xp6(2),n.AsE("y min, y max: ",e.layer.exportBounds()[1],", ",e.layer.exportBounds()[3],"")}}function Zi(o,t){if(1&o){const e=n.EpF();n.TgZ(0,"span",56),n._uU(1,"Modifier le style de tous les objets"),n.qZA(),n.TgZ(2,"div",57)(3,"span",58),n._uU(4,"Opacit\xe9 :"),n.qZA(),n.TgZ(5,"input",64,65),n.NdJ("change",function(){n.CHM(e);const r=n.MAs(6),s=n.oxw();return n.KtG(s.layer.container.opacity=r.value)}),n.qZA()(),n.TgZ(7,"div",57)(8,"span",58),n._uU(9,"Couleur de fond :"),n.qZA(),n.TgZ(10,"input",66,67),n.NdJ("change",function(){n.CHM(e);const r=n.MAs(11),s=n.oxw();return n.KtG(s.layer.container.fillColor=r.value)}),n.qZA(),n._UZ(12,"label"),n.TgZ(13,"input",68,69),n.NdJ("change",function(){n.CHM(e);const r=n.MAs(14),s=n.oxw();return n.KtG(s.layer.container.fillColor=r.value)}),n.qZA(),n._UZ(15,"label"),n.qZA(),n.TgZ(16,"div",57)(17,"span",58),n._uU(18,"Couleur du contour :"),n.qZA(),n.TgZ(19,"input",66,70),n.NdJ("change",function(){n.CHM(e);const r=n.MAs(20),s=n.oxw();return n.KtG(s.layer.container.strokeColor=r.value)}),n.qZA(),n._UZ(21,"label"),n.TgZ(22,"input",68,71),n.NdJ("change",function(){n.CHM(e);const r=n.MAs(23),s=n.oxw();return n.KtG(s.layer.container.strokeColor=r.value)}),n.qZA(),n._UZ(24,"label"),n.qZA(),n.TgZ(25,"div",57)(26,"span",58),n._uU(27,"Epaisseur du contour :"),n.qZA(),n.TgZ(28,"input",72,73),n.NdJ("change",function(){n.CHM(e);const r=n.MAs(29),s=n.oxw();return n.KtG(s.layer.container.strokeWidth=r.value)}),n.qZA()()}if(2&o){const e=n.oxw();n.xp6(5),n.Q6J("value",e.layer.container.opacity),n.xp6(5),n.Q6J("id","fillColor-"+e.layer.container.uuid)("value",e.layer.container.fillColor),n.xp6(2),n.uIk("for","fillColor-"+e.layer.container.uuid),n.xp6(1),n.Q6J("id","textFillColor-"+e.layer.container.uuid)("value",e.layer.container.fillColor),n.xp6(2),n.uIk("for","textFillColor-"+e.layer.container.uuid),n.xp6(4),n.Q6J("id","strokeColor-"+e.layer.container.uuid)("value",e.layer.container.strokeColor),n.xp6(2),n.uIk("for","strokeColor-"+e.layer.container.uuid),n.xp6(1),n.Q6J("id","textStrokeColor-"+e.layer.container.uuid)("value",e.layer.container.strokeColor),n.xp6(2),n.uIk("for","textStrokeColor-"+e.layer.container.uuid),n.xp6(4),n.Q6J("value",e.layer.container.strokeWidth)}}function Gi(o,t){if(1&o){const e=n.EpF();n.TgZ(0,"span",56),n._uU(1,"Exportation des donn\xe9es"),n.qZA(),n.TgZ(2,"ul",74)(3,"li",75)(4,"a",76),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.exportBuilder("geojson"))}),n._uU(5," GeoJSON "),n.qZA()(),n.TgZ(6,"li",75)(7,"a",77),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.exportBuilder("wkt"))}),n._uU(8," WKT "),n.qZA()(),n.TgZ(9,"li",75)(10,"a",77),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.exportBuilder("pytestFixture"))}),n._uU(11," Pytest Fixtures "),n.qZA()()(),n.TgZ(12,"div",78)(13,"div",79)(14,"textarea",80,81),n.NdJ("click",function(){n.CHM(e);const r=n.MAs(15);return n.KtG(r.select())}),n._uU(16),n.qZA()(),n.TgZ(17,"div",79)(18,"textarea",80,82),n.NdJ("click",function(){n.CHM(e);const r=n.MAs(19);return n.KtG(r.select())}),n._uU(20),n.qZA()(),n.TgZ(21,"div",79)(22,"textarea",80,83),n.NdJ("click",function(){n.CHM(e);const r=n.MAs(23);return n.KtG(r.select())}),n._uU(24),n.qZA()()()}if(2&o){const e=n.oxw();n.xp6(4),n.uIk("data-bs-target","#GeoJsonTab"+e.layer.container.uuid),n.xp6(3),n.uIk("data-bs-target","#wktTab"+e.layer.container.uuid),n.xp6(3),n.uIk("data-bs-target","#pytestFixture"+e.layer.container.uuid),n.xp6(3),n.Q6J("ngClass","geojson"===e.exportDataMode?"active":"")("id","GeoJsonTab"+e.layer.container.uuid),n.xp6(3),n.Oqu(e.exportData),n.xp6(1),n.Q6J("ngClass","wkt"===e.exportDataMode?"active":"")("id","wktTab"+e.layer.container.uuid),n.xp6(3),n.Oqu(e.exportData),n.xp6(1),n.Q6J("ngClass","pytestFixture"===e.exportDataMode?"active":"")("id","pytestFixture"+e.layer.container.uuid),n.xp6(3),n.Oqu(e.exportData)}}let Ai=(()=>{class o{constructor(e,i,r){this.elementRef=e,this.interactionsService=i,this.editComputingService=r,this.layerIdCurrentlySelected=new n.vpe,this.layerMoveUp=new n.vpe,this.layerMoveDown=new n.vpe,this.layerCloned=new n.vpe,this.removeLayerId=new n.vpe,this.groupIcon=_.Krp,this.helpIcon=_.FDd,this.addIcon=_.EQ8,this.editIcon=_.TzT,this.paramIcon=_.gr5,this.disabledIcon=_.g82,this.EditIcon=_.diR,this.pointIcon=_.diR,this.lineStringIcon=_.fQK,this.polygonIcon=_.ubJ,this.visibleIcon=_.Mdf,this.invisibleIcon=_.Aq,this.upIcon=_.l1h,this.downIcon=_.eW2,this.duplicateIcon=R.WM4,this.centerIcon=_.TL5,this.lockIcon=_.byT,this.unLockIcon=_._1N,this.unToggleIcon=R.El_,this.toggleIcon=R.CPW,this._selected=!1,this.displayTool=!1,this.isDrawn=!1,this.isEdited=!1,this.isShown=!1,this.isHole=!1,this.featuresIdSelected=[],this.displayLayerModal=!1,this.isLayerRemoved=!1,this.exportData="",this.exportDataMode="geojson",this.removeLayerSubscription=this.interactionsService.removeLayers.subscribe(s=>{this.removeLayer()}),this.featureIdEditedSubscription=this.editComputingService.snappingLayerEnabled.subscribe(s=>{s?this.layer.enableSnapping():this.layer.disableSnapping()})}ngOnInit(){this.layer.enableSelecting(),this.layerSelectConfigured(),this.layer.container.sourceFeatures.on("changefeature",e=>{Pt(e.feature)})}ngOnDestroy(){this.isLayerRemoved=!0;let e=document.getElementById("modalWktLayer-"+this.layer.container.uuid);null!==e&&e.remove(),this.removeLayerSubscription.unsubscribe(),this.featureIdEditedSubscription.unsubscribe(),this.layer.disableSelecting(),this.elementRef.nativeElement.remove()}toggleFeatures(){this.toggled=!this.toggled}set layer(e){this._layer=e}get layer(){return this._layer}set epsg(e){e!==this._epsg&&void 0!==this._epsg&&this.layer.container.features.forEach(i=>{i.setGeometry(i.getGeometry().transform(this._epsg,e))}),this._epsg=e}get epsg(){return this._epsg}set visible(e){this.layer.container.visible=e}get visible(){return this.layer.container.visible}set locked(e){this.layer.container.locked=e}get locked(){return this.layer.container.locked}set toggled(e){this.layer.container.featuresToggled=e}get toggled(){return this.layer.container.featuresToggled}set selected(e){e?this.selectLayer():this.unSelectFeatures(),this._selected=e}get selected(){return this._selected}layerSelectConfigured(){this.layer.select.on("select",e=>{let i=e.deselected,r=e.selected;e.mapBrowserEvent.originalEvent.shiftKey?r.forEach(s=>{this.featuresIdSelected.push(s.get("id")),this.layer.select.getFeatures().push(s),this.selectLayer()}):(i.length>0&&this.unSelectFeatures(),0==r.length&&(this.selected=!1),0==i.length&&(this.selected=!0),r.length>0&&r.forEach(s=>{this.featuresIdSelected.push(s.get("id")),this.layer.select.getFeatures().push(s)}))})}removeLayer(){this.layer.removeLayer(),this.removeLayerId.emit(this.layer.container.uuid),this.ngOnDestroy()}layerGoUp(){this.layerMoveUp.emit(this.layer.container.uuid)}layerGoDown(){this.layerMoveDown.emit(this.layer.container.uuid)}selectLayer(){this.interactionsService.sendSelectedLayerId(this.layer.container.uuid)}unSelectLayer(){this.interactionsService.sendSelectedLayerId(null)}zoomToLayer(){this.layer.zoomToLayer()}duplicateLayer(){this.unSelectFeatures();const e=Object.create(this.layer);this.layerCloned.emit(e)}hideModalLayer(){this.displayLayerModal=!1}displayLayerSettings(){this.displayLayerModal=!0,this.exportBuilder(this.exportDataMode)}exportBuilder(e){this.exportDataMode=e,"wkt"===e?this.exportData=this.layer.exportToWkt():"geojson"===e?this.exportData=this.layer.exportToGeoJSON():"pytestFixture"===e&&(this.exportData=this.layer.exportToPytestFixture())}unSelectFeatures(){this.featuresIdSelected=[],this.layer.select.getFeatures().clear()}selectFeatureById(e){this.unSelectFeatures(),this.featuresIdSelected.push(e);let i=this.getFeature(e);this.layer.select.getFeatures().push(i),this.selected=!0}getFeature(e){let i=this.layer.container.features.filter(r=>r.getId()===e);return 1===i.length?i[0]:null}}return o.\u0275fac=function(e){return new(e||o)(n.Y36(n.SBq),n.Y36(ne),n.Y36(Le))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-layer"]],inputs:{layersVisibleStatus:"layersVisibleStatus",layer:"layer",epsg:"epsg",visible:"visible",locked:"locked",toggled:"toggled",selected:"selected"},outputs:{layerIdCurrentlySelected:"layerIdCurrentlySelected",layerMoveUp:"layerMoveUp",layerMoveDown:"layerMoveDown",layerCloned:"layerCloned",removeLayerId:"removeLayerId"},decls:70,vars:34,consts:[[1,"layer","pointer","d-flex","flex-column","small","mt-1","mx-1","px-1","align-items-around"],[1,"header","d-flex","flex-row","border","rounded",3,"ngClass"],[1,"d-flex","flex-row","justify-content-start","align-items-center","me-1"],["type","checkbox",1,"btn-check",3,"id","checked","change"],["btnVisible",""],["container","body","triggers","mouseenter:mouseleave",1,"p-1","bg-transparent","border-0","pointer",3,"for","ngClass","ngbPopover"],["size","xs",1,"",3,"icon"],["btnLocked",""],["container","body","triggers","mouseenter:mouseleave",1,"ms-auto","p-1","bg-transparent","border-0","pointer",3,"for","ngbPopover"],[1,"d-flex","flex-column",3,"ngClass"],["container","body","ngbPopover","Remonter","triggers","mouseenter:mouseleave",1,"p-0","bg-transparent","border-0","text-danger",3,"click"],["container","body","ngbPopover","Descendre","triggers","mouseenter:mouseleave",1,"p-0","bg-transparent","border-0","text-danger",3,"click"],[1,"d-flex","flex-row","pointer","justify-content-start","align-items-center","flex-fill","p-1",3,"ngClass","click"],[1,""],["class","me-2","size","xs",3,"icon",4,"ngIf"],[1,"layer-name"],["ngbPopover","Masquer les objets","triggers","mouseenter:mouseleave",1,"ms-auto","p-1","bg-transparent","border-0",3,"click"],[1,"ms-auto","d-flex","flex-row",3,"ngClass"],["ngbPopover","Dupliquer","triggers","mouseenter:mouseleave",1,"ms-auto","p-1","bg-transparent","border-0",3,"click"],["ngbPopover","Supprimer","triggers","mouseenter:mouseleave",1,"ms-auto","p-1","bg-transparent","border-0","text-danger",3,"ngClass","click"],[1,"ms-auto","d-flex","flex-row"],["ngbPopover","Centrer","triggers","mouseenter:mouseleave",1,"ms-auto","p-1","bg-transparent","border-0",3,"click"],["data-bs-toggle","modal","ngbPopover","Options de la couche","triggers","mouseenter:mouseleave",1,"p-1","bg-transparent","border-0","text-black",3,"click"],["class","feature-container d-flex flex-row small mb-1",4,"ngIf"],["moveDivToBody","","class","position-fixed bottom-0 start-50 translate-middle-x",3,"isRemoved",4,"ngIf"],["moveDivToBody","","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade",3,"isRemoved","id"],[1,"modal-dialog","modal-lg","modal-dialog-scrollable"],[1,"modal-content"],[1,"modal-header"],["id","staticBackdropLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],["ngbNav","",1,"nav-tabs"],["nav","ngbNav"],["ngbNavItem",""],["ngbNavLink","",1,"fw-bold"],["ngbNavContent",""],[1,"nav-content","mx-2",3,"ngbNavOutlet"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["ngNavLayerGeneral",""],["ngNavLayerStyling",""],["ngNavLayerExporting",""],["size","xs",1,"me-2",3,"icon"],[1,"feature-container","d-flex","flex-row","small","mb-1"],["id","featuresList",1,"w-100","list-group","list-unstyled","list-group-flush","mx-3","rounded",3,"hidden","id"],[1,"feature","border-bottom",3,"ngClass","click"],[1,"feature","d-flex","flex-row","pointer","justify-content-center","align-items-center","flex-fill","m-1"],[1,"me-1",3,"icon"],[4,"ngFor","ngForOf"],[1,"feature",3,"ngClass","selected","feature","layer","click"],["moveDivToBody","",1,"position-fixed","bottom-0","start-50","translate-middle-x",3,"isRemoved"],["class","",3,"layer","enabled","currentEpsg",4,"ngIf"],[1,"",3,"layer","enabled","currentEpsg"],[1,"d-flex","flex-column"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"fs-4","my-2"],[1,"d-flex","flex-row","align-items-center","my-2"],[1,"fs-6","me-2"],["type","text","aria-label","layerName",1,"form-control","w-50",3,"placeholder","change"],["layerName",""],[1,"d-flex","flex-column","my-2"],[1,"fs-6"],[1,"ms-3"],["id","","type","range","min","0","max","1","step","0.1",1,"small","opacity-setter",3,"value","change"],["opacityInput",""],["type","color",1,"fillColor","pointer","border-0",3,"id","value","change"],["layerFillColor",""],["type","text",1,"fillColor","p-0","border-1",3,"id","value","change"],["textLayerFillColor",""],["layerStrokeColor",""],["textLayerStrokeColor",""],["type","number","min","0","max","12",1,"small","strokeWidth",3,"value","change"],["strokeWidth",""],["role","tablist",1,"nav","nav-pills","align-items-center","justify-content-center"],["role","presentation",1,"nav-item","border","m-1"],["data-bs-toggle","tab","type","button","role","tab",1,"nav-link","fw-bold","active",3,"click"],["data-bs-toggle","tab","type","button","role","tab",1,"nav-link","fw-bold",3,"click"],["id","'tabContent' + layer.container.id",1,"d-flex","flex-row","mx-2","tab-content"],["role","tabpanel",1,"tab-pane","fade","w-100","show",3,"ngClass","id"],["aria-label","With textarea","readonly","",1,"form-control","vh-100",3,"click"],["exportGeoJsonStringGeomDiv",""],["exportWktStringGeomDiv",""],["exportPytestFixturesGeomDiv",""]],template:function(e,i){if(1&e){const r=n.EpF();n.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"input",3,4),n.NdJ("change",function(){n.CHM(r);const a=n.MAs(4);return n.KtG(i.visible=a.checked)}),n.qZA(),n.TgZ(5,"label",5),n._UZ(6,"fa-icon",6),n.qZA(),n.TgZ(7,"input",3,7),n.NdJ("change",function(){n.CHM(r);const a=n.MAs(8);return n.KtG(i.locked=a.checked)}),n.qZA(),n.TgZ(9,"label",8),n._UZ(10,"fa-icon",6),n.qZA(),n.TgZ(11,"div",9)(12,"button",10),n.NdJ("click",function(){return i.layerGoUp()}),n._UZ(13,"fa-icon",6),n.qZA(),n.TgZ(14,"button",11),n.NdJ("click",function(){return i.layerGoDown()}),n._UZ(15,"fa-icon",6),n.qZA()()(),n.TgZ(16,"div",12),n.NdJ("click",function(){return i.selected=!0}),n.TgZ(17,"div",13),n.YNc(18,Ci,1,1,"fa-icon",14),n.YNc(19,xi,1,1,"fa-icon",14),n.YNc(20,Ti,1,1,"fa-icon",14),n.qZA(),n.TgZ(21,"div",15)(22,"span"),n._uU(23),n.qZA()()(),n.TgZ(24,"button",16),n.NdJ("click",function(){return i.toggleFeatures()}),n._UZ(25,"fa-icon",6),n.qZA(),n.TgZ(26,"div",17)(27,"button",18),n.NdJ("click",function(){return i.duplicateLayer()}),n._UZ(28,"fa-icon",6),n.qZA(),n.TgZ(29,"button",19),n.NdJ("click",function(){return i.removeLayer()}),n._UZ(30,"fa-icon",6),n.qZA()(),n.TgZ(31,"div",20)(32,"button",21),n.NdJ("click",function(){return i.zoomToLayer()}),n._UZ(33,"fa-icon",6),n.qZA(),n.TgZ(34,"button",22),n.NdJ("click",function(){return i.displayLayerSettings()}),n._UZ(35,"fa-icon",6),n.qZA()()(),n.YNc(36,bi,7,5,"div",23),n.qZA(),n.YNc(37,Pi,2,2,"div",24),n.TgZ(38,"div",25)(39,"div",26)(40,"div",27)(41,"div",28)(42,"h5",29),n._uU(43),n.qZA(),n.TgZ(44,"button",30),n.NdJ("click",function(){return i.hideModalLayer()}),n.qZA()(),n.TgZ(45,"div",31)(46,"ul",32,33)(48,"li",34)(49,"a",35),n._uU(50,"G\xe9n\xe9ral"),n.qZA(),n.YNc(51,Li,2,4,"ng-template",36),n.qZA(),n.TgZ(52,"li",34)(53,"a",35),n._uU(54,"Style de la couche"),n.qZA(),n.YNc(55,Ii,2,4,"ng-template",36),n.qZA(),n.TgZ(56,"li",34)(57,"a",35),n._uU(58,"Exporter"),n.qZA(),n.YNc(59,Mi,2,4,"ng-template",36),n.qZA()(),n._UZ(60,"div",37),n.qZA(),n.TgZ(61,"div",38)(62,"button",39),n._uU(63,"Fermer"),n.qZA()()()()(),n.YNc(64,ki,19,6,"ng-template",null,40,n.W1O),n.YNc(66,Zi,30,14,"ng-template",null,41,n.W1O),n.YNc(68,Gi,25,12,"ng-template",null,42,n.W1O)}if(2&e){const r=n.MAs(47);n.xp6(1),n.Q6J("ngClass",i.selected?"border-dark border-2":""),n.xp6(2),n.Q6J("id","btnVisible"+i.layer.container.uuid)("checked",i.visible),n.xp6(2),n.Q6J("for","btnVisible"+i.layer.container.uuid)("ngClass",i.visible?"text-success":"text-danger")("ngbPopover",i.visible?"Masquer":"Afficher"),n.xp6(1),n.Q6J("icon",i.visible?i.visibleIcon:i.invisibleIcon),n.xp6(1),n.Q6J("id","btnLocked"+i.layer.container.uuid)("checked",i.locked),n.xp6(2),n.Q6J("for","btnLocked"+i.layer.container.uuid)("ngbPopover",i.locked?"D\xe9verrouiller":"Verrouiller"),n.xp6(1),n.Q6J("icon",i.locked?i.lockIcon:i.unLockIcon),n.xp6(1),n.Q6J("ngClass",i.selected?"pe-auto":"pe-none"),n.xp6(2),n.Q6J("icon",i.upIcon),n.xp6(2),n.Q6J("icon",i.downIcon),n.xp6(1),n.Q6J("ngClass",i.selected?"fw-bold":"text-black"),n.xp6(2),n.Q6J("ngIf","Point"===i.layer.container.geomType),n.xp6(1),n.Q6J("ngIf","LineString"===i.layer.container.geomType),n.xp6(1),n.Q6J("ngIf","Polygon"===i.layer.container.geomType),n.xp6(3),n.Oqu(i.layer.container.layerName),n.xp6(2),n.Q6J("icon",i.toggled?i.toggleIcon:i.unToggleIcon),n.xp6(1),n.Q6J("ngClass",i.selected?"d-block":"d-none"),n.xp6(2),n.Q6J("icon",i.duplicateIcon),n.xp6(1),n.Q6J("ngClass",i.locked?"pe-none":"pe-auto"),n.xp6(1),n.Q6J("icon",i.disabledIcon),n.xp6(3),n.Q6J("icon",i.centerIcon),n.xp6(1),n.uIk("data-bs-target","#modalLayerSettings-"+i.layer.container.uuid),n.xp6(1),n.Q6J("icon",i.paramIcon),n.xp6(1),n.Q6J("ngIf",i.layer.container.features.length>0),n.xp6(1),n.Q6J("ngIf",!i.isLayerRemoved),n.xp6(1),n.Q6J("isRemoved",i.isLayerRemoved)("id","modalLayerSettings-"+i.layer.container.uuid),n.xp6(5),n.Oqu(i.layer.container.layerName),n.xp6(17),n.Q6J("ngbNavOutlet",r)}},dependencies:[w.mk,w.sg,w.O5,w.tP,A.BN,I.uN,I.Pz,I.nv,I.Is,I.Vx,I.tO,I.Dy,I.o8,Me,hi,yi],styles:[".layer[_ngcontent-%COMP%]{background-color:var(--bs-light)}.layer[_ngcontent-%COMP%]   .layer-name[_ngcontent-%COMP%]:hover{font-weight:700}.layer[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{animation-name:_ngcontent-%COMP%_layerColorTransition;animation-duration:2s}@keyframes _ngcontent-%COMP%_layerColorTransition{0%{background-color:var(--bs-warning)}to{background-color:var(--bs-light)}}.toast[_ngcontent-%COMP%]{opacity:0;display:unset!important;transition:opacity .5s}.faded[_ngcontent-%COMP%]{opacity:1!important;transition:opacity .5s!important}.pointer[_ngcontent-%COMP%]{cursor:pointer}.colorPicker[_ngcontent-%COMP%]{width:10px;height:25px;cursor:pointer}.feature[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{font-weight:700}#editBar[_ngcontent-%COMP%]{position:fixed;bottom:0;-webkit-user-select:none;user-select:none}"]}),o})();var Oi=m(6422),Ft=m(9851);const Ke="projection",Lt="coordinateFormat",Di=class Ni extends Oi.Z{constructor(t){t=t||{};const e=document.createElement("div");e.className=void 0!==t.className?t.className:"ol-mouse-position",super({element:e,render:t.render,target:t.target}),this.addChangeListener(Ke,this.handleProjectionChanged_),t.coordinateFormat&&this.setCoordinateFormat(t.coordinateFormat),t.projection&&this.setProjection(t.projection),this.renderOnMouseOut_=void 0!==t.placeholder,this.placeholder_=this.renderOnMouseOut_?t.placeholder:"&#160;",this.renderedHTML_=e.innerHTML,this.mapProjection_=null,this.transform_=null,this.wrapX_=!1!==t.wrapX}handleProjectionChanged_(){this.transform_=null}getCoordinateFormat(){return this.get(Lt)}getProjection(){return this.get(Ke)}handleMouseMove(t){const e=this.getMap();this.updateHTML_(e.getEventPixel(t))}handleMouseOut(t){this.updateHTML_(null)}setMap(t){if(super.setMap(t),t){const e=t.getViewport();this.listenerKeys.push((0,M.oL)(e,Ft.Z.POINTERMOVE,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push((0,M.oL)(e,Ft.Z.POINTEROUT,this.handleMouseOut,this)),this.updateHTML_(null)}}setCoordinateFormat(t){this.set(Lt,t)}setProjection(t){this.set(Ke,(0,y.U2)(t))}updateHTML_(t){let e=this.placeholder_;if(t&&this.mapProjection_){if(!this.transform_){const s=this.getProjection();this.transform_=s?(0,y.WO)(this.mapProjection_,s):y.gD}const r=this.getMap().getCoordinateFromPixelInternal(t);if(r){const s=(0,y.Cs)();if(s&&(this.transform_=(0,y.WO)(this.mapProjection_,s)),this.transform_(r,r),this.wrapX_){const l=s||this.getProjection()||this.mapProjection_;(0,P.Cf)(r,l)}const a=this.getCoordinateFormat();e=a?a(r):r.toString()}}(!this.renderedHTML_||e!==this.renderedHTML_)&&(this.element.innerHTML=e,this.renderedHTML_=e)}render(t){const e=t.frameState;e?this.mapProjection_!=e.viewState.projection&&(this.mapProjection_=e.viewState.projection,this.transform_=null):this.mapProjection_=null}};function Ji(o,t){if(1&o){const e=n.EpF();n.ynx(0),n._UZ(1,"input",10),n.TgZ(2,"label",11),n.NdJ("click",function(){const s=n.CHM(e).$implicit,a=n.oxw();return n.KtG(a.setProjection(s))}),n.TgZ(3,"div",12)(4,"span"),n._uU(5),n.qZA()()(),n.BQk()}if(2&o){const e=t.$implicit,i=t.index,r=n.oxw();n.xp6(1),n.Q6J("id","btnradio-selector-"+i)("checked",r.currentEpsg===e),n.xp6(1),n.Q6J("ngClass",r.currentEpsg===e?"bg-success text-white ":"")("for","btnradio-selector-"+i),n.xp6(3),n.Oqu(e)}}let Ri=(()=>{class o{constructor(e){this.mapService=e,this.defaultCoordsPrecision=4}ngAfterViewInit(){this.initMousePosition()}updatePrecision(e){this.mousePositionControl.setCoordinateFormat(this.setPrecisionFunc(e.target.value))}setProjection(e){this.currentEpsg=e,this.mapService.setProjectionOnMap(e),this.setMapEpsg()}initMousePosition(){let e;e=document.getElementById("mouseCoordinates"),this.mousePositionControl=new Di({coordinateFormat:this.setPrecisionFunc(this.defaultCoordsPrecision),placeholder:"x :<br>y : ",className:"mouse-position",target:e}),this.map.addControl(this.mousePositionControl)}setPrecisionFunc(e){return function(r){return(0,P.WU)(r,"x : {x}<br>y : {y}",e)}}setMapEpsg(){this.currentEpsg=this.map.getView().getProjection().getCode()}}return o.\u0275fac=function(e){return new(e||o)(n.Y36(Se.S))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-geo-tools"]],inputs:{currentEpsg:"currentEpsg",map:"map",epsgAvailable:"epsgAvailable"},decls:12,vars:1,consts:[[1,"text-center","fw-bold","bg-success","bg-gradient","text-white","p-2"],["id","epsgList",1,"text-center","m-3"],[1,"btn-group","m-2","bg-white","rounded-3","border"],[4,"ngFor","ngForOf"],["id","ccordinates",1,"d-flex","flex-column","justify-content-center","align-items-center","m-3"],[1,"d-flex","flex-column"],["id","mouseCoordinates"],[1,"d-flex","flex-row","my-2"],[1,"fw-bold","me-3"],["id","precision","type","number","min","0","max","12","value","4",1,"small","text-center",3,"change"],["type","radio","name","btnRadio","autocomplete","off",1,"border","btn-check",3,"id","checked"],[1,"pointer","p-2",3,"ngClass","for","click"],[1,"dropdown-item","small","d-flex","flex-row"]],template:function(e,i){1&e&&(n.TgZ(0,"div",0),n._uU(1," Projection\n"),n.qZA(),n.TgZ(2,"div",1)(3,"div",2),n.YNc(4,Ji,6,5,"ng-container",3),n.qZA()(),n.TgZ(5,"div",4)(6,"div",5),n._UZ(7,"span",6),n.qZA(),n.TgZ(8,"div",7)(9,"span",8),n._uU(10,"Pr\xe9cision"),n.qZA(),n.TgZ(11,"input",9),n.NdJ("change",function(s){return i.updatePrecision(s)}),n.qZA()()()),2&e&&(n.xp6(4),n.Q6J("ngForOf",i.epsgAvailable))},dependencies:[w.mk,w.sg],styles:[".pointer[_ngcontent-%COMP%]{cursor:pointer}"]}),o})();function ji(o,t){if(1&o){const e=n.EpF();n.ynx(0),n.TgZ(1,"button",3),n.NdJ("click",function(){const s=n.CHM(e).$implicit,a=n.oxw();return n.KtG(a.addLayer(s.mode))}),n._UZ(2,"fa-icon",4),n.qZA(),n.BQk()}if(2&o){const e=t.$implicit;n.xp6(1),n.Q6J("ngbPopover",e.label),n.xp6(1),n.Q6J("icon",e.icon)}}let Ui=(()=>{class o{constructor(){this.newLayerEvent=new n.vpe,this._pointIcon=_.diR,this._lineStringIcon=_.fQK,this._polygonIcon=_.ubJ,this._layerTypes=[{mode:"Point",label:"Ajouter une couche de Points",icon:this._pointIcon},{mode:"LineString",label:"Ajouter une couche de LineString",icon:this._lineStringIcon},{mode:"Polygon",label:"Ajouter une couche de Polygones",icon:this._polygonIcon}]}ngOnInit(){this.layerTypesModes=this._layerTypes.filter(e=>this.layerTypeModes.includes(e.mode))}addLayer(e){this.newLayerEvent.emit(e)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-create-tools"]],inputs:{layerTypeModes:"layerTypeModes"},outputs:{newLayerEvent:"newLayerEvent"},decls:4,vars:1,consts:[[1,"text-center","fw-bold","bg-dark","bg-gradient","text-white","p-2"],["id","creationTools",1,"text-center","m-3"],[4,"ngFor","ngForOf"],["placement","bottom","triggers","mouseenter:mouseleave",1,"btn","btn-sm","btn-dark","border-0","me-1","text-warning",3,"ngbPopover","click"],[1,"",3,"icon"]],template:function(e,i){1&e&&(n.TgZ(0,"div",0),n._uU(1," Cr\xe9er "),n.qZA(),n.TgZ(2,"div",1),n.YNc(3,ji,3,2,"ng-container",2),n.qZA()),2&e&&(n.xp6(3),n.Q6J("ngForOf",i.layerTypesModes))},dependencies:[w.sg,A.BN,I.o8]}),o})();var Bi=m(6488),Qi=m(529);let qi=(()=>{class o{constructor(e){this.http=e,this.apiUrl=Bi.n+"api/v1/network-api/",this.shortestPathRoute=this.apiUrl+"path/shortest"}getShortestPathFromApi(e,i="vehicle"){return this.http.get(this.shortestPathRoute,{params:{mode:i,step_point:e}})}}return o.\u0275fac=function(e){return new(e||o)(n.LFG(Qi.eN))},o.\u0275prov=n.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Hi=(()=>{class o{constructor(e,i){this.editComputingService=e,this.graphComputingService=i,this.pathIcon=_.KJ_,this.motorIcon=_.yn$,this.pedestrianIcon=_.EiI}ngOnInit(){}ngOnDestroy(){}set layersToDisplay(e){e.forEach(i=>{["Polygon","LineString"].includes(i.container.geomType)&&(i.container.featuresToggled=!0)})}set layerSelected(e){this.buttonEnabled=!1,null!==e&&"Point"===e.container.geomType&&(this.buttonEnabled=!0),this._layerSelected=e}get layerSelected(){return this._layerSelected}computeShortestPath(e){let i=[];if(null!==this.layerSelected){this.layerSelected.container.features.forEach(s=>{let l=s.clone().getGeometry();void 0!==l&&("EPSG:4326"!==this.currentEpsg&&(l=l.transform(this.currentEpsg,"EPSG:4326")),i.push(Fe(l)))});const r={dataProjection:"EPSG:4326",featureProjection:this.currentEpsg};this.graphComputingService.getShortestPathFromApi(i,e).subscribe(s=>{const a=Ve(s,r);this.editComputingService.addNewFeatures(a)})}}}return o.\u0275fac=function(e){return new(e||o)(n.Y36(Le),n.Y36(qi))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-path-tools"]],inputs:{currentEpsg:"currentEpsg",layersToDisplay:"layersToDisplay",layerSelected:"layerSelected"},decls:7,vars:3,consts:[[1,"text-center","fw-bold","bg-success","bg-gradient","text-white","p-2"],[1,"d-flex","flex-row","justify-content-center","m-1",3,"ngClass"],["ngbPopover","Pi\xe9ton",1,"btn","btn-sm","btn-outline-secondary","border-0",3,"click"],[3,"icon"],["ngbPopover","Motoris\xe9",1,"btn","btn-sm","btn-outline-secondary","border-0",3,"click"]],template:function(e,i){1&e&&(n.TgZ(0,"div",0),n._uU(1," Plus court chemin\n"),n.qZA(),n.TgZ(2,"div",1)(3,"button",2),n.NdJ("click",function(){return i.computeShortestPath("pedestrian")}),n._UZ(4,"fa-icon",3),n.qZA(),n.TgZ(5,"button",4),n.NdJ("click",function(){return i.computeShortestPath("vehicle")}),n._UZ(6,"fa-icon",3),n.qZA()()),2&e&&(n.xp6(2),n.Q6J("ngClass",i.buttonEnabled?"pe-auto":"pe-none"),n.xp6(2),n.Q6J("icon",i.pedestrianIcon),n.xp6(2),n.Q6J("icon",i.motorIcon))},dependencies:[w.mk,A.BN,I.o8]}),o})();const Vi=["exportStringGeomDiv"];function Yi(o,t){if(1&o&&(n.ynx(0),n._UZ(1,"app-geo-tools",21),n.BQk()),2&o){const e=n.oxw();n.xp6(1),n.Q6J("map",e.map)("currentEpsg",e.currentEpsg)("epsgAvailable",e.epsgAvailable)}}const Ki=function(){return["Point","LineString","Polygon"]};function Wi(o,t){if(1&o){const e=n.EpF();n.ynx(0),n.TgZ(1,"app-create-tools",22),n.NdJ("newLayerEvent",function(r){n.CHM(e);const s=n.oxw();return n.KtG(s.addLayer(r))}),n.qZA(),n.TgZ(2,"app-import-tools",23),n.NdJ("featuresToNewLayerEvent",function(r){n.CHM(e);const s=n.oxw();return n.KtG(s.createNewLayersFromFeatures(r))})("featuresToAppendEvent",function(r){n.CHM(e);const s=n.oxw();return n.KtG(s.appendFeatureOnLayerFromFeatures(r))}),n.qZA(),n.BQk()}if(2&o){const e=n.oxw();n.xp6(1),n.Q6J("layerTypeModes",n.DdM(4,Ki)),n.xp6(1),n.Q6J("epsgAvailable",e.epsgAvailable)("currentEpsg",e.currentEpsg)("existingLayers",e.existingLayers)}}const Xi=function(){return["Point","LineString"]};function zi(o,t){if(1&o){const e=n.EpF();n.ynx(0),n.TgZ(1,"app-create-tools",24),n.NdJ("newLayerEvent",function(r){n.CHM(e);const s=n.oxw();return n.KtG(s.addLayer(r))}),n.qZA(),n._UZ(2,"app-path-tools",25),n.BQk()}if(2&o){const e=n.oxw();n.xp6(1),n.Q6J("layerTypeModes",n.DdM(4,Xi)),n.xp6(1),n.Q6J("currentEpsg",e.currentEpsg)("layerSelected",e.getLayerFromId(e.layerIdSelected))("layersToDisplay",e.layersToDisplay)}}function $i(o,t){if(1&o){const e=n.EpF();n.ynx(0),n.TgZ(1,"app-layer",26),n.NdJ("layerMoveUp",function(r){n.CHM(e);const s=n.oxw();return n.KtG(s.layerGoUp(r))})("layerMoveDown",function(r){n.CHM(e);const s=n.oxw();return n.KtG(s.layerGoDown(r))})("layerCloned",function(r){n.CHM(e);const s=n.oxw();return n.KtG(s.duplicateLayer(r))})("removeLayerId",function(r){n.CHM(e);const s=n.oxw();return n.KtG(s.removeLayer(r))}),n.qZA(),n.BQk()}if(2&o){const e=t.$implicit,i=n.oxw();n.xp6(1),n.Q6J("layer",e)("selected",i.layerIdSelected==e.container.uuid)("visible",i.allVisible)("locked",i.allLocked)("toggled",i.allToggled)("epsg",i.currentEpsg)}}let er=(()=>{class o{constructor(e,i,r){this.mapService=e,this.interactionsService=i,this.editComputingService=r,this.disabledIcon=_.g82,this.loadIcon=_.cf$,this.visibleIcon=R.Mdf,this.invisibleIcon=_.Aq,this.centerIcon=_.TL5,this.lockIcon=_.byT,this.unLockIcon=_._1N,this.unToggleIcon=R.El_,this.toggleIcon=R.CPW,this.allToggled=!1,this.allVisible=!0,this.allLocked=!1,this.existingLayers=[],this.layersToDisplay=[],this.layerIdSelected=null,this.layerNamedIncrement=-1,this.zoomPadding=[100,100,100,100],this.epsgChangesSubscription=this.mapService.setMapProjectionFromEpsg.subscribe(s=>{this.currentEpsg=s}),this.layerIdSelectedSubscription=this.interactionsService.layerIdSelected.subscribe(s=>{this.layerIdSelected=s}),this.newFeaturesSubscription=this.editComputingService.newFeatures.subscribe(s=>{this.createNewLayersFromFeatures(s)})}ngOnInit(){this._mapExamplesData()}ngOnDestroy(){this.existingLayers.forEach(e=>{this.map.removeLayer(e.container.layer),e.cleanEvents()}),this.epsgChangesSubscription.unsubscribe(),this.layerIdSelectedSubscription.unsubscribe(),this.newFeaturesSubscription.unsubscribe()}_mapExamplesData(){const r=Ve([...$n,...ei,...ti],{dataProjection:this.currentEpsg,featureProjection:"EPSG:3857"});this.createNewLayersFromFeatures(r)}set toolsMode(e){this._toolsMode=e,this.refreshLayers()}get toolsMode(){return this._toolsMode}set currentEpsg(e){this._currentEpsg=e}get currentEpsg(){return this._currentEpsg}addLayer(e){let i=this.setNewLayer(e);this.existingLayers.push(i),this.refreshLayers()}setNewLayer(e,i=null,r=null){const s=++this.layerNamedIncrement;null===i&&(i="layer "+s);let a=new Hn(i,e,s);return new Vn(this.map,a)}duplicateLayer(e){let i=this.setNewLayer(e.container.geomType,e.container.layerName+" copy");i.container.addFeaturesAndUpdateIds(e.container.features),this.existingLayers.push(i),this.refreshLayers()}addLayerFromFeatures(e,i){let r=this.setNewLayer(e);r.container.addFeaturesAndUpdateIds(i),this.existingLayers.push(r),this.refreshLayers()}layerGoUp(e){this.existingLayers=wt(this.existingLayers,e,1),this.refreshLayers()}layerGoDown(e){this.existingLayers=wt(this.existingLayers,e,-1),this.refreshLayers()}removeLayer(e){this.existingLayers=this.existingLayers.filter(i=>i.container.uuid!==e),this.buildLayersIndexes(),this.refreshLayers()}getLayerFromId(e){return null!==e?this.existingLayers.filter(r=>r.container.uuid===e)[0]:null}refreshLayers(){this.layersToDisplay=this.existingLayers.sort((e,i)=>e.container.zIndex>i.container.zIndex?-1:1),this.interactionsService.sendAllLayers(this.layersToDisplay)}unSelectLayer(){this.layerIdSelected=null}buildLayersIndexes(){let e=this.existingLayers;this.existingLayers=[],e.forEach((i,r)=>{i.container.zIndex=r,this.existingLayers.push(i)})}createNewLayersFromFeatures(e){Object.keys(e).forEach(i=>{this.addLayerFromFeatures(i,e[i])})}appendFeatureOnLayerFromFeatures(e){const r=e.features;let s=this.getLayerFromId(e.layerId);if(null!==s){const a=s.container.geomType;let l=s.container;Object.keys(r).forEach(c=>{c===a&&(l.addFeaturesAndUpdateIds(r[c]),this.refreshLayers())})}}zoomLayers(){let e=(0,x.lJ)();this.existingLayers.forEach(i=>{(0,x.l7)(e,i.container.sourceFeatures.getExtent())}),e[0]!==1/0&&e[1]!==1/0&&e[2]!==1/0&&e[3]!==1/0&&this.map.getView().fit(e,{size:this.map.getSize(),padding:this.zoomPadding})}removeLayers(){this.interactionsService.removeAllLayers()}}return o.\u0275fac=function(e){return new(e||o)(n.Y36(Se.S),n.Y36(ne),n.Y36(Le))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-layers-manager"]],viewQuery:function(e,i){if(1&e&&n.Gf(Vi,5),2&e){let r;n.iGM(r=n.CRH())&&(i.exportStringGeomDiv=r.first)}},inputs:{map:"map",epsgAvailable:"epsgAvailable",toolsMode:"toolsMode",currentEpsg:"currentEpsg"},decls:29,vars:18,consts:[[4,"ngIf"],[1,"text-center","fw-bold","bg-primary","bg-gradient","text-white","p-2"],["id","layersTools",1,"d-flex","flex-row","justify-content-evenly","align-items-center","mx-2"],["type","checkbox","id","btnVisibleLayers",1,"btn-check",3,"checked","change"],["btnVisible",""],["for","btnVisibleLayers","container","body","triggers","mouseenter:mouseleave",1,"m-1","btn","btn-sm","btn-transparent","border-0","pointer",3,"ngClass","ngbPopover"],["size","1x",1,"",3,"icon"],["type","checkbox","id","btnLockLayers",1,"btn-check",3,"checked","change"],["btnLock",""],["for","btnLockLayers","container","body","triggers","mouseenter:mouseleave",1,"m-1","btn","btn-sm","btn-transparent","border-0","pointer",3,"ngbPopover"],["type","checkbox","id","btnToggleFeatures",1,"btn-check",3,"checked","change"],["btnToggle",""],["for","btnToggleFeatures","container","body","triggers","mouseenter:mouseleave",1,"m-1","btn","btn-sm","btn-transparent","border-0","pointer",3,"ngbPopover"],["ngbPopover","Centrer","triggers","mouseenter:mouseleave",1,"m-1","btn","btn-sm","btn-transparent","border-0","pointer",3,"click"],["ngbPopover","Supprimer toutes les couches","triggers","mouseenter:mouseleave",1,"m-1","btn","btn-sm","btn-transparent","border-0","pointer","text-danger",3,"click"],["id","layersList",1,"d-flex","flex-column","justify-content-start","mb-2"],["layersList",""],[1,"layer","pointer","d-flex","flex-column","small","mt-1","mx-1","px-1","align-items-around",3,"ngClass","click"],[1,"pointer","p-2","d-flex","flex-row","pointer","justify-content-center","align-items-center","border-bottom"],[1,"me-1",3,"icon"],[4,"ngFor","ngForOf"],["id","geoTools",1,"overflow-auto",3,"map","currentEpsg","epsgAvailable"],[3,"layerTypeModes","newLayerEvent"],[3,"epsgAvailable","currentEpsg","existingLayers","featuresToNewLayerEvent","featuresToAppendEvent"],["classColor","danger",3,"layerTypeModes","newLayerEvent"],[3,"currentEpsg","layerSelected","layersToDisplay"],[3,"layer","selected","visible","locked","toggled","epsg","layerMoveUp","layerMoveDown","layerCloned","removeLayerId"]],template:function(e,i){if(1&e){const r=n.EpF();n.YNc(0,Yi,2,3,"ng-container",0),n.YNc(1,Wi,3,5,"ng-container",0),n.YNc(2,zi,3,5,"ng-container",0),n.TgZ(3,"div",1),n._uU(4," Couches\n"),n.qZA(),n.TgZ(5,"div",2)(6,"input",3,4),n.NdJ("change",function(){n.CHM(r);const a=n.MAs(7);return n.KtG(i.allVisible=a.checked)}),n.qZA(),n.TgZ(8,"label",5),n._UZ(9,"fa-icon",6),n.qZA(),n.TgZ(10,"input",7,8),n.NdJ("change",function(){n.CHM(r);const a=n.MAs(11);return n.KtG(i.allLocked=a.checked)}),n.qZA(),n.TgZ(12,"label",9),n._UZ(13,"fa-icon",6),n.qZA(),n.TgZ(14,"input",10,11),n.NdJ("change",function(){n.CHM(r);const a=n.MAs(15);return n.KtG(i.allToggled=a.checked)}),n.qZA(),n.TgZ(16,"label",12),n._UZ(17,"fa-icon",6),n.qZA(),n.TgZ(18,"button",13),n.NdJ("click",function(){return i.zoomLayers()}),n._UZ(19,"fa-icon",6),n.qZA(),n.TgZ(20,"button",14),n.NdJ("click",function(){return i.removeLayers()}),n._UZ(21,"fa-icon",6),n.qZA()(),n.TgZ(22,"div",15,16)(24,"div",17),n.NdJ("click",function(){return i.unSelectLayer()}),n.TgZ(25,"div",18),n._UZ(26,"fa-icon",19),n._uU(27,"D\xe9s\xe9lectionner "),n.qZA()(),n.YNc(28,$i,2,6,"ng-container",20),n.qZA()}2&e&&(n.Q6J("ngIf","geoTools"==i.toolsMode),n.xp6(1),n.Q6J("ngIf","createTools"==i.toolsMode),n.xp6(1),n.Q6J("ngIf","pathTools"==i.toolsMode),n.xp6(4),n.Q6J("checked",i.allVisible),n.xp6(2),n.Q6J("ngClass",i.allVisible?"text-success":"text-danger")("ngbPopover",i.allVisible?"Masquer":"Afficher"),n.xp6(1),n.Q6J("icon",i.allVisible?i.visibleIcon:i.invisibleIcon),n.xp6(1),n.Q6J("checked",!1),n.xp6(2),n.Q6J("ngbPopover",i.allLocked?"D\xe9v\xe9rouiller":"Verrouiller"),n.xp6(1),n.Q6J("icon",i.allLocked?i.lockIcon:i.unLockIcon),n.xp6(1),n.Q6J("checked",!i.allVisible),n.xp6(2),n.Q6J("ngbPopover",i.allToggled?"Masquer":"Afficher"),n.xp6(1),n.Q6J("icon",i.allToggled?i.toggleIcon:i.unToggleIcon),n.xp6(2),n.Q6J("icon",i.centerIcon),n.xp6(2),n.Q6J("icon",i.disabledIcon),n.xp6(3),n.Q6J("ngClass",null===i.layerIdSelected?"bg-secondary  bg-gradient bg-opacity-25 fw-bold text-black":"text-black"),n.xp6(2),n.Q6J("icon",i.disabledIcon),n.xp6(2),n.Q6J("ngForOf",i.layersToDisplay))},dependencies:[w.mk,w.sg,w.O5,A.BN,I.o8,Ai,Ri,Ui,si,Hi],styles:[".pointer[_ngcontent-%COMP%]{cursor:pointer}"]}),o})();function tr(o,t){if(1&o&&(n.O4$(),n.TgZ(0,"svg",9),n._UZ(1,"circle",10),n.qZA()),2&o){const e=n.oxw().$implicit;n.xp6(1),n.uIk("stroke",e.get("stroke_color"))("stroke-width",e.get("stroke_width"))("fill",e.get("fill_color"))}}function nr(o,t){if(1&o&&(n.O4$(),n.TgZ(0,"svg",9),n._UZ(1,"line",11)(2,"line",11),n.qZA()),2&o){const e=n.oxw().$implicit;n.xp6(1),n.uIk("stroke",e.get("stroke_color"))("stroke-width",2*e.get("stroke_width")),n.xp6(1),n.uIk("stroke",e.get("fill_color"))("stroke-width",1.5*e.get("stroke_width"))}}function ir(o,t){if(1&o&&(n.O4$(),n.TgZ(0,"svg",12),n._UZ(1,"rect",13),n.qZA()),2&o){const e=n.oxw().$implicit;n.xp6(1),n.uIk("stroke",e.get("stroke_color"))("stroke-width",e.get("stroke_width"))("fill",e.get("fill_color"))}}function rr(o,t){if(1&o){const e=n.EpF();n.TgZ(0,"li")(1,"div",4),n.NdJ("click",function(){const s=n.CHM(e).$implicit,a=n.oxw();return n.KtG(a.selectFeatureById(s.getId()))}),n.TgZ(2,"div",5),n.YNc(3,tr,2,3,"svg",6),n.YNc(4,nr,3,4,"svg",6),n.YNc(5,ir,2,3,"svg",7),n.qZA(),n.TgZ(6,"span",8),n._uU(7),n.qZA()()()}if(2&o){const e=t.$implicit,i=n.oxw();n.xp6(1),n.Q6J("ngClass",i.featureIdSelected==e.getId()?"bg-secondary bg-opacity-25 rounded":""),n.xp6(2),n.Q6J("ngIf","Point"===e.get("geom_type")),n.xp6(1),n.Q6J("ngIf","LineString"===e.get("geom_type")),n.xp6(1),n.Q6J("ngIf","Polygon"===e.get("geom_type")),n.xp6(2),n.Oqu(e.get("name"))}}let sr=(()=>{class o{constructor(e){this.interactionsService=e,this.pointIcon=dn,this.lineStringIcon=un,this.polygonIcon=hn}ngOnInit(){this.layer.enableSelecting(),this.layerSelectConfigured()}ngOnDestroy(){this.unSelectFeature()}set layer(e){this._layer=e}get layer(){return this._layer}set selected(e){e?this.selectLayer():this.unSelectFeature(),this._selected=e}get selected(){return this._selected}layerSelectConfigured(){this.layer.select.on("select",e=>{let r=e.selected;e.deselected.length>0&&0===r.length&&this.unSelectFeature(),r.length>0&&r.forEach(s=>{this.selectFeatureById(s.getId())})})}unSelectFeature(){this.featureIdSelected="none",this.layer.select.getFeatures().clear()}selectFeatureById(e){this.featureIdSelected=e;let i=this.getFeature(this.featureIdSelected);this.layer.enableSelecting(),this.layer.select.getFeatures().clear(),this.layer.select.getFeatures().push(i),this.selectLayer()}getFeature(e){let i=this.layer.container.features.filter(r=>r.getId()===e);return 1===i.length?i[0]:null}selectLayer(){this.interactionsService.sendSelectedLayerId(this.layer.container.uuid)}}return o.\u0275fac=function(e){return new(e||o)(n.Y36(ne))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-legend"]],inputs:{layer:"layer",selected:"selected"},decls:5,vars:2,consts:[[1,"d-flex","flex-row","fs-6","title"],[1,"text-decoration-underline","mb-2","fw-bold"],[1,"list-unstyled","m-0"],[4,"ngFor","ngForOf"],[1,"d-flex","flex-row","align-items-center","px-2","mx-2","pointer",3,"ngClass","click"],[1,"me-1"],["height","25","width","25",4,"ngIf"],["height","15","width","25",4,"ngIf"],[1,"small"],["height","25","width","25"],["cx","12","cy","12","r","8"],["x1","0","y1","12.5","x2","25","y2","12.5"],["height","15","width","25"],["x","0","y","0","width","25","height","15"]],template:function(e,i){1&e&&(n.TgZ(0,"div",0)(1,"span",1),n._uU(2),n.qZA()(),n.TgZ(3,"ul",2),n.YNc(4,rr,8,5,"li",3),n.qZA()),2&e&&(n.xp6(2),n.Oqu(i.layer.container.layerName),n.xp6(2),n.Q6J("ngForOf",i.layer.container.features))},dependencies:[w.mk,w.sg,w.O5]}),o})();function or(o,t){if(1&o&&(n.ynx(0),n.TgZ(1,"div",13),n._UZ(2,"app-legend",14),n.qZA(),n.BQk()),2&o){const e=t.$implicit,i=n.oxw(2);n.xp6(2),n.Q6J("layer",e)("selected",i.layerIdSelected==e.container.uuid)}}function ar(o,t){if(1&o&&(n.TgZ(0,"div",10)(1,"div",11),n.YNc(2,or,3,2,"ng-container",12),n.qZA()()),2&o){const e=n.oxw();n.xp6(2),n.Q6J("ngForOf",e.currentLayers)}}const lr=[{path:"",component:(()=>{class o{constructor(e,i,r,s){this.mapService=e,this.controlerService=i,this.activatedRoute=r,this.interactionsService=s,this.epsgAvailable=["EPSG:4326","EPSG:3857"],this.geoIcon=_.g4A,this.pathIcon=_.KJ_,this.leftSideIcon=_._Wx,this.rightSideIcon=_.ccb,this.layersIcon=_.Krp,this.isPanelsDisplayed=!0,this.toolsMode="createTools",this.layerIdSelected=null,this.mapSubscription=this.mapService.map.subscribe(a=>{this.map=a,this.currentEpsg=this.map.getView().getProjection().getCode(),this.defaultMapView=this.map.getView()}),this.allLayersSubscription=this.interactionsService.allLayers.subscribe(a=>{this.currentLayers=a}),this.layerIdSelectedSubscription=this.interactionsService.layerIdSelected.subscribe(a=>{this.layerIdSelected=a})}ngOnInit(){this.sendResumeSubMenus(),this.mapService.changeMapInteractionStatus(!0),this.mapService.getMap()}ngOnDestroy(){this.map.setView(this.defaultMapView),this.mapSubscription.unsubscribe(),this.allLayersSubscription.unsubscribe(),this.layerIdSelectedSubscription.unsubscribe(),this.mapService.changeMapInteractionStatus(!1),this.mapService.resetMapView()}sendResumeSubMenus(){this.controlerService.pullSubMenus([]),this.controlerService.pullTitlePage(this.activatedRoute.snapshot.data.title)}showHideLegend(){this.isPanelsDisplayed=!this.isPanelsDisplayed,this.unSelectLayer()}unSelectLayer(){this.interactionsService.sendSelectedLayerId(null)}}return o.\u0275fac=function(e){return new(e||o)(n.Y36(Se.S),n.Y36(It.L),n.Y36(Ie.gz),n.Y36(ne))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-app-layout"]],decls:13,vars:14,consts:[["fluidHeight","","id","sandbox",1,"d-flex","flex-row","position-fixed"],["id","panelsContainer",1,"d-flex","flex-column","bg-light",3,"ngClass"],["id","createTools",1,"overflow-auto",3,"map","toolsMode","currentEpsg","epsgAvailable"],["id","legendLabels",1,"d-flex","flex-column"],[1,"tool","btn","btn-warning","text-black","my-3","shadow","rounded-end",3,"ngClass","click"],[3,"icon"],[1,"tool","btn","btn-success","text-white","mb-1","shadow","rounded-end",3,"ngClass","click"],["type","button",1,"tool","btn","btn-dark","text-white","mb-1","shadow","rounded-end",3,"ngClass","click"],["type","button",1,"tool","btn","btn-danger","text-white","mb-1","shadow","rounded-end",3,"ngClass","click"],["moveDivToBody","","class","position-fixed bottom-0 end-0 bg-white rounded shadow overflow-auto mb-3 me-3",4,"ngIf"],["moveDivToBody","",1,"position-fixed","bottom-0","end-0","bg-white","rounded","shadow","overflow-auto","mb-3","me-3"],[1,"d-flex","flex-row","justify-content-start"],[4,"ngFor","ngForOf"],[1,"m-3"],[3,"layer","selected"]],template:function(e,i){1&e&&(n.TgZ(0,"div",0)(1,"div",1),n._UZ(2,"app-layers-manager",2),n.qZA(),n.TgZ(3,"div",3)(4,"span",4),n.NdJ("click",function(){return i.showHideLegend()}),n._UZ(5,"fa-icon",5),n.qZA(),n.TgZ(6,"span",6),n.NdJ("click",function(){return i.toolsMode="geoTools"}),n._UZ(7,"fa-icon",5),n.qZA(),n.TgZ(8,"span",7),n.NdJ("click",function(){return i.toolsMode="createTools"}),n._UZ(9,"fa-icon",5),n.qZA(),n.TgZ(10,"span",8),n.NdJ("click",function(){return i.toolsMode="pathTools"}),n._UZ(11,"fa-icon",5),n.qZA()()(),n.YNc(12,ar,3,1,"div",9)),2&e&&(n.xp6(1),n.Q6J("ngClass",i.isPanelsDisplayed?"displayed":"hidden"),n.xp6(1),n.Q6J("map",i.map)("toolsMode",i.toolsMode)("currentEpsg",i.currentEpsg)("epsgAvailable",i.epsgAvailable),n.xp6(2),n.Q6J("ngClass",i.isPanelsDisplayed?"selected":""),n.xp6(1),n.Q6J("icon",i.isPanelsDisplayed?i.leftSideIcon:i.rightSideIcon),n.xp6(1),n.Q6J("ngClass","geoTools"===i.toolsMode?"selected":""),n.xp6(1),n.Q6J("icon",i.geoIcon),n.xp6(1),n.Q6J("ngClass","createTools"===i.toolsMode?"selected":""),n.xp6(1),n.Q6J("icon",i.layersIcon),n.xp6(1),n.Q6J("ngClass","pathTools"===i.toolsMode?"selected":""),n.xp6(1),n.Q6J("icon",i.pathIcon),n.xp6(1),n.Q6J("ngIf",!i.isPanelsDisplayed&&i.currentLayers.length>0))},dependencies:[w.mk,w.sg,w.O5,A.BN,St,Me,er,sr],styles:["#panelsContainer[_ngcontent-%COMP%]{box-shadow:1em 0 1rem #00000026!important}#panelsContainer.displayed[_ngcontent-%COMP%]{transition:all .3s}#panelsContainer.displayed[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{opacity:1;transition:all .1s}#panelsContainer.hidden[_ngcontent-%COMP%]{transition:all .3s}#panelsContainer.hidden[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{opacity:0;transition:all .1s}@media (max-width: 960px){#panelsContainer.hidden[_ngcontent-%COMP%]{width:3vw}#panelsContainer.displayed[_ngcontent-%COMP%]{width:40vw}}@media (min-width: 960px){#panelsContainer.hidden[_ngcontent-%COMP%]{width:1vw}#panelsContainer.displayed[_ngcontent-%COMP%]{width:18vw}}.tool[_ngcontent-%COMP%]{border-radius:unset;transition:all .1s}.tool.btn[_ngcontent-%COMP%]{width:45px}.tool.btn[_ngcontent-%COMP%]:hover, .tool.btn.selected[_ngcontent-%COMP%]{width:60px}#editBar[_ngcontent-%COMP%]{position:fixed;bottom:0;-webkit-user-select:none;user-select:none}"]}),o})(),data:{title:"Bac \xe0 sable",page:"map-sandbox"},outlet:"map-sandbox"}];let cr=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=n.oAB({type:o}),o.\u0275inj=n.cJS({imports:[Ie.Bz.forChild(lr),Ie.Bz]}),o})();var dr=m(5540);let ur=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=n.oAB({type:o}),o.\u0275inj=n.cJS({imports:[w.ez,cr,A.uH,I.IJ,j.u5,dr.o]}),o})()}}]);